<!DOCTYPE html>

<html dir="rtl" lang="ar">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>ูุญุงูุงุฉ ูุนุฑูุฉ ุจูู ูููููุณ ูุงูููููููู</title>
<!-- Chart.js for data visualization -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<!-- Font Awesome for icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-19HNCP3BE3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-19HNCP3BE3');
</script>
<style>
    /* General Styles */
    * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    body {
        background-color: #033c73; /* Deeper blue background */
        background: linear-gradient(135deg, #033c73, #0099cc); /* Blue gradient similar to game interface */
        background-size: cover;
        background-attachment: fixed;
        color: #333;
        line-height: 1.6;
        padding: 20px;
        /* Protection against content copying */
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        -webkit-touch-callout: none;
        -webkit-tap-highlight-color: transparent;
    }

    .container {
        max-width: 1200px;
        margin: 0 auto;
        background-color: rgba(255, 255, 255, 0.9);
        border-radius: 10px;
        box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
        padding: 20px;
    }

    h1, h2, h3, h4 {
        color: #2c3e50;
        margin-bottom: 15px;
    }

    h1 {
        text-align: center;
        font-size: 32px;
        border-bottom: 2px solid #3498db;
        padding-bottom: 10px;
        margin-bottom: 20px;
    }

    p {
        margin-bottom: 15px;
    }

    /* Header Section */
    .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
    }

    .logo-container {
        display: flex;
        align-items: center;
        gap: 20px;
    }

    .faction-logo {
        width: 60px;
        height: 60px;
        object-fit: contain;
    }

    .header-image {
        max-width: 100%;
        height: auto;
        display: block;
        margin: 0 auto 20px;
        border-radius: 5px;
    }

    /* Tabs */
    .tabs {
        display: flex;
        justify-content: center;
        flex-wrap: wrap;
        margin-bottom: 20px;
        gap: 5px;
    }

    .tab-button {
        padding: 12px 20px;
        border: none;
        background-color: #95a5a6;
        color: white;
        cursor: pointer;
        font-weight: bold;
        border-radius: 5px 5px 0 0;
        transition: background-color 0.3s;
    }

    .tab-button:hover {
        background-color: #7f8c8d;
    }

    .tab-button.active {
        background-color: #3498db;
    }

    .tab-content {
        display: none;
        padding: 20px;
        background-color: white;
        border-radius: 0 5px 5px 5px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }

    .tab-content.active {
        display: block;
    }

    /* Form Elements */
    .form-group {
        margin-bottom: 15px;
    }

    label {
        display: block;
        margin-bottom: 5px;
        font-weight: bold;
        color: #2c3e50;
    }

    .input-row {
        display: flex;
        flex-wrap: wrap;
        gap: 15px;
        margin-bottom: 15px;
    }

    .input-group {
        flex: 1;
        min-width: 200px;
    }

    select, input {
        width: 100%;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 4px;
        font-size: 16px;
    }

    button {
        background-color: #3498db;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 4px;
        cursor: pointer;
        font-size: 16px;
        font-weight: bold;
        transition: background-color 0.3s;
    }

    button:hover {
        background-color: #2980b9;
    }
    
    button:disabled {
        background-color: #95a5a6;
        cursor: not-allowed;
    }

    /* Tables */
    table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 20px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }

    th, td {
        padding: 12px 15px;
        text-align: right;
        border-bottom: 1px solid #ddd;
    }

    th {
        background-color: #3498db;
        color: white;
        font-weight: bold;
    }

    tr:nth-child(even) {
        background-color: #f9f9f9;
    }

    tr:hover {
        background-color: #f1f1f1;
    }

    .table-header {
        font-weight: bold;
        background-color: #3498db;
        color: white;
    }

    .positive-diff {
        color: #27ae60;
        font-weight: bold;
    }

    .negative-diff {
        color: #e74c3c;
        font-weight: bold;
    }

    .important-stat {
        font-weight: bold;
        background-color: #f0f8ff;
    }

    /* Charts */
    .chart-container {
        margin: 20px 0;
        height: 300px;
        width: 100%;
    }

    .comparison-result {
        margin-top: 20px;
        padding: 20px;
        background-color: #f9f9f9;
        border-radius: 5px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }

    .chart-row {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        margin: 20px 0;
    }

    .chart-column {
        flex: 1;
        min-width: 300px;
    }

    /* Battle Simulation */
    .army-config {
        padding: 15px;
        margin-bottom: 20px;
        background-color: #f9f9f9;
        border-radius: 5px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }

    .helios-config {
        border-right: 5px solid #3498db; /* Blue for Helios */
    }

    .dominant-config {
        border-right: 5px solid #e74c3c; /* Red for Dominant */
    }

    .troop-count {
        font-weight: bold;
        color: #3498db;
    }

    /* Percentage sliders */
    .percentage-slider-container {
        display: flex;
        align-items: center;
        margin-bottom: 10px;
    }
    
    .percentage-slider-container label {
        min-width: 120px;
        margin-right: 10px;
        margin-bottom: 0;
    }
    
    .percentage-slider-container input[type="range"] {
        flex: 1;
        height: 10px;
        border-radius: 5px;
        background: #ddd;
        outline: none;
    }
    
    .percentage-slider-container input[type="number"] {
        width: 60px;
        margin-right: 10px;
        text-align: center;
    }
    
    .percentage-total {
        margin-top: 10px;
        font-weight: bold;
        text-align: center;
        padding: 5px;
        border-radius: 5px;
    }
    
    .percentage-total.valid {
        background-color: #e8f5e9;
        color: #388e3c;
    }
    
    .percentage-total.invalid {
        background-color: #ffebee;
        color: #d32f2f;
    }

    /* Battle Results */
    .battle-results {
        display: none;
        margin-top: 30px;
        padding: 20px;
        background-color: #f9f9f9;
        border-radius: 5px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }

    .battle-winner {
        font-size: 24px;
        text-align: center;
        padding: 15px;
        margin-bottom: 20px;
        border-radius: 5px;
        font-weight: bold;
    }

    .battle-winner.helios {
        background-color: #e3f2fd;
        color: #1565c0;
    }

    .battle-winner.dominant {
        background-color: #ffebee;
        color: #c62828;
    }

    .battle-winner.draw {
        background-color: #eaeded;
        color: #7f8c8d;
    }

    .battle-details {
        padding: 15px;
        background-color: white;
        border-radius: 5px;
        margin-bottom: 20px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }

    .battle-stats {
        font-size: 16px;
        padding: 15px;
        background-color: #f0f8ff;
        border-radius: 5px;
    }
    
    /* Combat mechanics */
    .combat-mechanics {
        margin: 20px 0;
        padding: 15px;
        background-color: #eaf2f8;
        border-radius: 5px;
        border-right: 3px solid #3498db;
    }
    
    /* Skills */
    .skills-container {
        margin-top: 20px;
        padding: 15px;
        background-color: #fff8e1;
        border-radius: 5px;
        border-right: 3px solid #ffc107;
    }
    
    .skill-badge {
        display: inline-block;
        margin: 5px;
        padding: 5px 10px;
        border-radius: 15px;
        font-size: 12px;
        color: white;
        background: linear-gradient(135deg, #3498db, #2980b9);
        box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }
    
    .skill-title {
        font-weight: bold;
        margin-bottom: 3px;
    }
    
    /* Countdown */
    .countdown {
        font-size: 48px;
        font-weight: bold;
        text-align: center;
        margin: 20px 0;
        color: #3498db;
    }
    
    /* Result GIF */
    .result-gif {
        display: block;
        max-width: 100%;
        margin: 20px auto;
        border-radius: 5px;
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    
    /* Analysis */
    .analysis {
        padding: 15px;
        background-color: #e8f5e9;
        border-radius: 5px;
        margin-top: 20px;
        border-right: 3px solid #4caf50;
    }
    
    /* Footer */
    .footer {
        margin-top: 50px;
        text-align: center;
        padding: 20px;
        background-color: #2196f3;
        color: white;
        border-radius: 5px;
    }
    
    .footer a {
        color: #e3f2fd;
        margin: 0 10px;
        text-decoration: none;
    }
    
    .footer a:hover {
        text-decoration: underline;
        color: #ffffff;
    }
    
    /* Social Media Icons */
    .social-icons {
        position: fixed;
        top: 50%;
        left: 20px;
        transform: translateY(-50%);
        display: flex;
        flex-direction: column;
        gap: 15px;
        z-index: 1000;
    }
    
    .social-icon {
        display: block;
        width: 60px;
        height: 60px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        text-decoration: none;
        font-size: 24px;
        box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        transition: all 0.3s ease;
        opacity: 0.8;
    }
    
    .social-icon:hover {
        transform: scale(1.1);
        opacity: 1;
        box-shadow: 0 6px 12px rgba(0,0,0,0.3);
    }
    
    .youtube-icon {
        background-color: #ff0000;
    }
    
    .discord-icon {
        background-color: #7289da;
    }
    
    /* Modal Overlay */
    .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.8);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 9999;
        backdrop-filter: blur(5px);
    }
    
    .modal-content {
        background-color: white;
        padding: 40px;
        border-radius: 15px;
        text-align: center;
        max-width: 500px;
        width: 90%;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        animation: modalAppear 0.3s ease-out;
    }
    
    @keyframes modalAppear {
        from {
            opacity: 0;
            transform: scale(0.8);
        }
        to {
            opacity: 1;
            transform: scale(1);
        }
    }
    
    .modal-title {
        font-size: 24px;
        color: #333;
        margin-bottom: 30px;
        font-weight: bold;
        line-height: 1.4;
    }
    
    .modal-buttons {
        display: flex;
        gap: 20px;
        justify-content: center;
        flex-wrap: wrap;
    }
    
    .modal-btn {
        padding: 15px 30px;
        border: none;
        border-radius: 10px;
        font-size: 18px;
        font-weight: bold;
        color: white;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 10px;
        transition: all 0.3s ease;
        min-width: 200px;
        justify-content: center;
    }
    
    .modal-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    }
    
    .youtube-btn {
        background-color: #FF0000;
    }
    
    .youtube-btn:hover {
        background-color: #CC0000;
    }
    
    .discord-btn {
        background-color: #7289DA;
    }
    
    .discord-btn:hover {
        background-color: #5B6FB8;
    }
    
    .modal-icon {
        font-size: 20px;
    }
    
    /* Hidden class for modal */
    .hidden {
        display: none !important;
    }
    
    .credits {
        font-style: italic;
        text-align: center;
        font-size: 12px;
        margin: 10px 0;
        color: #555;
    }
    
    /* Promotional message */
    .promotional-message {
        background: #e3f2fd;
        padding: 10px;
        margin: 15px 0;
        border-radius: 5px;
        border-right: 4px solid #2196f3;
        font-weight: bold;
        color: #0d47a1;
        text-align: center;
    }
    
    /* Challenge Tab Styles */
    .challenge-container {
        display: flex;
        flex-direction: column;
        gap: 20px;
    }

    .player-info {
        padding: 20px;
        background-color: #f8f9fa;
        border-radius: 8px;
        border-right: 4px solid #3498db;
    }

    .challenge-form {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 15px;
        margin-bottom: 20px;
    }

    .challenge-list {
        background-color: #fff;
        border: 1px solid #ddd;
        border-radius: 8px;
        padding: 15px;
        margin: 20px 0;
    }

    .challenge-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 15px;
        margin: 10px 0;
        background-color: #f8f9fa;
        border-radius: 5px;
        border-right: 3px solid #ffc107;
    }

    .challenge-item:hover {
        background-color: #e9ecef;
    }

    .challenge-info {
        flex: 1;
    }

    .challenge-actions {
        display: flex;
        gap: 10px;
    }

    .btn-accept {
        background-color: #28a745;
    }

    .btn-accept:hover {
        background-color: #218838;
    }

    .army-composition {
        background-color: #fff;
        padding: 20px;
        border-radius: 8px;
        border: 1px solid #ddd;
        margin: 15px 0;
    }

    .composition-row {
        display: flex;
        align-items: center;
        margin-bottom: 15px;
        gap: 15px;
    }

    .composition-label {
        min-width: 100px;
        font-weight: bold;
    }

    .composition-slider {
        flex: 1;
        margin: 0 10px;
    }

    .composition-value {
        min-width: 60px;
        text-align: center;
        font-weight: bold;
        color: #3498db;
    }

    .weekly-champion {
        background: linear-gradient(135deg, #ffd700, #ffed4e);
        padding: 20px;
        border-radius: 10px;
        margin: 20px 0;
        text-align: center;
        border: 2px solid #f39c12;
    }

    .champion-avatar {
        width: 80px;
        height: 80px;
        border-radius: 50%;
        margin: 0 auto 15px;
        background: linear-gradient(135deg, #3498db, #2980b9);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 24px;
        font-weight: bold;
    }

    .champion-stats {
        display: flex;
        justify-content: space-around;
        margin-top: 15px;
    }

    .stat-item {
        text-align: center;
    }

    .stat-number {
        font-size: 24px;
        font-weight: bold;
        color: #2c3e50;
    }

    .stat-label {
        font-size: 12px;
        color: #7f8c8d;
    }

    .challenge-waiting {
        background-color: #fff3cd;
        border: 1px solid #ffeaa7;
        color: #856404;
        padding: 15px;
        border-radius: 5px;
        text-align: center;
        margin: 20px 0;
    }

    .battle-preparation {
        background-color: #e3f2fd;
        border: 1px solid #bbdefb;
        padding: 20px;
        border-radius: 8px;
        margin: 20px 0;
    }

    .vs-indicator {
        text-align: center;
        font-size: 32px;
        font-weight: bold;
        color: #e74c3c;
        margin: 20px 0;
    }

    .level-skills {
        background-color: #f8f9fa;
        padding: 15px;
        border-radius: 5px;
        margin: 15px 0;
        border-right: 3px solid #17a2b8;
    }

    .skill-list {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin-top: 10px;
    }

    .skill-item {
        background: linear-gradient(135deg, #6c757d, #495057);
        color: white;
        padding: 8px 12px;
        border-radius: 15px;
        font-size: 12px;
        font-weight: bold;
    }

    /* Share Results Styles */
    .share-btn {
        padding: 12px 20px;
        border: none;
        border-radius: 8px;
        font-size: 14px;
        font-weight: bold;
        color: white;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 8px;
        text-decoration: none;
        min-width: 120px;
        justify-content: center;
    }

    .share-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    }

    .whatsapp-btn {
        background: linear-gradient(135deg, #25D366, #128C7E);
    }

    .whatsapp-btn:hover {
        background: linear-gradient(135deg, #128C7E, #075E54);
    }

    .telegram-btn {
        background: linear-gradient(135deg, #0088cc, #005580);
    }

    .telegram-btn:hover {
        background: linear-gradient(135deg, #005580, #003d5c);
    }

    .twitter-btn {
        background: linear-gradient(135deg, #1DA1F2, #0d8bd9);
    }

    .twitter-btn:hover {
        background: linear-gradient(135deg, #0d8bd9, #0a6ebd);
    }

    .facebook-btn {
        background: linear-gradient(135deg, #1877F2, #0d6efd);
    }

    .facebook-btn:hover {
        background: linear-gradient(135deg, #0d6efd, #0a58ca);
    }

    .copy-btn {
        background: linear-gradient(135deg, #6c757d, #495057);
    }

    .copy-btn:hover {
        background: linear-gradient(135deg, #495057, #343a40);
    }

    /* Mobile responsiveness for share buttons */
    @media screen and (max-width: 768px) {
        .share-buttons {
            flex-direction: column;
            align-items: center;
        }

        .share-btn {
            min-width: 200px;
            margin: 5px 0;
        }
    }

    @media screen and (max-width: 480px) {
        .share-btn {
            font-size: 13px;
            padding: 10px 15px;
            min-width: 180px;
        }
    }

    /* Comments System Styles */
    .comments-section {
        background-color: #f8f9fa;
        border-radius: 8px;
        padding: 20px;
        margin: 20px 0;
        border-right: 4px solid #17a2b8;
    }

    .comment-form {
        background-color: white;
        padding: 15px;
        border-radius: 5px;
        margin-bottom: 20px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .comment-input {
        width: 100%;
        min-height: 80px;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 4px;
        resize: vertical;
        font-family: inherit;
    }

    .comment-item {
        background-color: white;
        padding: 15px;
        margin: 10px 0;
        border-radius: 5px;
        border-right: 3px solid #007bff;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .comment-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 10px;
        border-bottom: 1px solid #eee;
        padding-bottom: 8px;
    }

    .comment-author {
        font-weight: bold;
        color: #2c3e50;
    }

    .comment-date {
        font-size: 12px;
        color: #666;
    }

    .comment-text {
        color: #333;
        line-height: 1.5;
    }

    .comments-counter {
        display: flex;
        align-items: center;
        gap: 5px;
        margin-bottom: 15px;
        font-weight: bold;
        color: #495057;
    }

    /* Mobile responsiveness */
    @media screen and (max-width: 768px) {
        body {
            padding: 10px;
        }

        .container {
            padding: 15px;
            margin: 0;
            border-radius: 5px;
        }

        h1 {
            font-size: 24px;
            margin-bottom: 15px;
        }

        .tabs {
            flex-direction: column;
            gap: 2px;
            margin-bottom: 15px;
        }

        .tab-button {
            padding: 15px;
            font-size: 16px;
            border-radius: 5px;
            margin: 2px 0;
            min-height: 50px;
        }

        .input-row {
            flex-direction: column;
            gap: 15px;
        }
        
        .input-group {
            width: 100%;
        }

        .input-group label {
            font-size: 16px;
            margin-bottom: 8px;
        }

        .input-group select,
        .input-group input {
            padding: 15px;
            font-size: 16px;
            border-radius: 8px;
            min-height: 50px;
        }
        
        .chart-row {
            flex-direction: column;
        }
        
        /* ุชุญุณูู ุชุดูููุฉ ุงูุฌูุด ููููุงุชู */
        .army-config {
            margin-bottom: 25px;
            padding: 20px;
        }

        .army-config h3,
        .army-config h4 {
            font-size: 18px;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .percentage-slider-container {
            flex-direction: column;
            margin-bottom: 20px;
            background-color: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .percentage-slider-container label {
            width: 100%;
            margin-bottom: 10px;
            font-size: 16px;
            font-weight: bold;
            text-align: center;
            color: #2c3e50;
        }
        
        .percentage-slider-container input[type="range"] {
            width: 100%;
            height: 15px;
            margin: 10px 0;
            -webkit-appearance: none;
            background: #ddd;
            border-radius: 10px;
            outline: none;
        }

        .percentage-slider-container input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: #3498db;
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        }

        .percentage-slider-container input[type="range"]::-moz-range-thumb {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: #3498db;
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        }
        
        .percentage-slider-container input[type="number"] {
            width: 100%;
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            color: #3498db;
            margin-top: 5px;
            padding: 10px;
            border: 2px solid #3498db;
            border-radius: 8px;
        }

        .percentage-total {
            font-size: 18px;
            padding: 15px;
            text-align: center;
            border-radius: 8px;
            margin: 15px 0;
            font-weight: bold;
        }

        .composition-row {
            flex-direction: column;
            background-color: #f8f9fa;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            text-align: center;
        }

        .composition-label {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 10px;
            min-width: auto;
        }

        .composition-slider {
            width: 100% !important;
            height: 15px;
            margin: 10px 0;
        }

        .composition-value {
            font-size: 20px;
            font-weight: bold;
            color: #3498db;
            margin-top: 10px;
        }

        .challenge-form {
            grid-template-columns: 1fr;
            gap: 20px;
        }

        .challenge-item {
            flex-direction: column;
            text-align: center;
            padding: 20px;
        }

        .challenge-actions {
            margin-top: 15px;
            width: 100%;
        }

        .challenge-actions button {
            width: 100%;
            padding: 15px;
            font-size: 16px;
        }

        /* ุชุญุณูู ูุชุงุฆุฌ ุงููุนุฑูุฉ ููููุงุชู */
        .battle-stats {
            font-size: 14px;
        }

        .battle-stats > div {
            grid-template-columns: 1fr !important;
            gap: 15px;
        }

        .share-buttons {
            flex-direction: column !important;
            align-items: center;
        }

        .share-btn {
            min-width: 90% !important;
            margin: 5px 0 !important;
            padding: 15px !important;
            font-size: 16px !important;
        }

        /* ุชุญุณูู ุงูุชุนูููุงุช ููููุงุชู */
        .comments-section {
            padding: 15px;
            margin: 15px 0;
        }

        .comment-form {
            padding: 15px;
        }

        .comment-input {
            min-height: 100px;
            font-size: 16px;
            padding: 15px;
        }

        .comment-item {
            padding: 15px;
            margin: 15px 0;
        }

        .comment-header {
            flex-direction: column;
            align-items: flex-start;
            gap: 5px;
        }

        .comment-author {
            font-size: 16px;
        }

        .comment-date {
            font-size: 12px;
        }

        .comment-text {
            font-size: 15px;
            line-height: 1.6;
        }

        /* ุชุญุณูู ุงูููุฏุงู ููููุงุชู */
        .modal-content {
            width: 95%;
            padding: 25px;
            margin: 10px;
        }

        .modal-title {
            font-size: 20px;
            line-height: 1.3;
        }

        .modal-btn {
            min-width: 100%;
            padding: 18px;
            font-size: 16px;
            margin: 5px 0;
        }

        /* ุชุญุณูู ุงูุฌุฏุงูู ููููุงุชู */
        table {
            font-size: 12px;
        }

        th, td {
            padding: 8px 5px;
            text-align: center;
        }

        /* ุชุญุณูู ุงูุฑุณูู ุงูุจูุงููุฉ ููููุงุชู */
        .chart-container {
            height: 250px;
            margin: 15px 0;
        }

        .chart-column {
            min-width: 100%;
            margin-bottom: 20px;
        }
    }

    @media screen and (max-width: 480px) {
        .container {
            padding: 10px;
        }

        h1 {
            font-size: 20px;
        }

        .tab-button {
            font-size: 14px;
            padding: 12px;
        }

        .percentage-slider-container {
            padding: 12px;
        }

        .percentage-slider-container label {
            font-size: 14px;
        }

        .army-config {
            padding: 15px;
        }

        .share-btn {
            font-size: 14px !important;
            padding: 12px !important;
        }

        .modal-content {
            padding: 20px;
        }

        .modal-title {
            font-size: 18px;
        }
    }
</style>
</head>
<body>
<!-- Modal Overlay -->
<div id="subscriptionModal" class="modal-overlay">
    <div class="modal-content">
        <h2 class="modal-title">ูุฑุฌู ุงูุงุดุชุฑุงู ูู ุงูููุงุฉ ูุชุฌุฑุจุฉ ูุญุงูุงุฉ ุงููุชุงู</h2>
        <div class="modal-buttons">
            <a href="https://www.youtube.com/@whiteoutsurvivel" target="_blank" class="modal-btn youtube-btn" onclick="trackClick('YouTube_Modal'); hideModal();">
                <i class="fab fa-youtube modal-icon"></i>
                ุงุดุชุฑู ูู YouTube
            </a>
            <a href="https://discord.gg/yEKvcA5eBq" target="_blank" class="modal-btn discord-btn" onclick="trackClick('Discord_Modal'); hideModal();">
                <i class="fab fa-discord modal-icon"></i>
                ุงูุถู ุฅูู Discord
            </a>
        </div>
    </div>
</div>

<!-- Social Media Icons -->
<div class="social-icons">
    <a href="https://www.youtube.com/@whiteoutsurvivel" target="_blank" class="social-icon youtube-icon" title="ููุงุฉ ุงูููุชููุจ" onclick="trackClick('YouTube_SideIcon')">
        โถ
    </a>
    <a href="https://discord.gg/yEKvcA5eBq" target="_blank" class="social-icon discord-icon" title="ุฏูุณููุฑุฏ" onclick="trackClick('Discord_SideIcon')">
        ๐ฌ
    </a>
</div>

<div class="container">
    <header>
        <img class="header-image" id="coverImage" alt="ุตูุฑุฉ ุงูุบูุงู" src="https://i.imgur.com/pKGIpPk.gif" />
        <h1>ูุญุงูุงุฉ ูุนุฑูุฉ ุจูู ูููููุณ ูุงูููููููู</h1>
    </header>
    
    <div class="tabs">
        <button class="tab-button active" data-tab="infantry-comparison">ููุงุฑูุฉ ุงููุดุงุฉ</button>
        <button class="tab-button" data-tab="archers-comparison">ููุงุฑูุฉ ุงูุฑูุงุฉ</button>
        <button class="tab-button" data-tab="spearmen-comparison">ููุงุฑูุฉ ุงูุฑูุญ</button>
        <button class="tab-button" data-tab="battle-simulation">ูุญุงูุงุฉ ุงููุชุงู</button>
        <button class="tab-button" data-tab="challenge">ุงูุชุญุฏู</button>
    </div>
    
    <!-- Infantry Comparison Tab -->
    <div id="infantry-comparison" class="tab-content active">
        <div class="logo-container">
            <div class="faction-logo">๐ก๏ธ ูููููุณ</div>
            <h2>ููุงุฑูุฉ ุงููุดุงุฉ</h2>
            <div class="faction-logo">๐ก๏ธ ุงูููููููู</div>
        </div>
        
        <div class="promotional-message">
            ูุฏุนูู ููุงุดุชุฑุงู ูู ููุงุชูุง ูุฏุนู ุงููุดุฑูุน! Whiteout Survival Comparison ุงููุนุงููุฑ ูุง ุชุดูู ุนุชุงุฏ ุงูุญุงูู.
        </div>
        
        <div class="input-row">
            <div class="input-group">
                <label for="heliosInfantryLevel">ูุณุชูู ูุดุงุฉ ูููููุณ</label>
                <select id="heliosInfantryLevel">
                    <option value="1">ูุณุชูู 1</option>
                    <option value="2">ูุณุชูู 2</option>
                    <option value="3">ูุณุชูู 3</option>
                    <option value="4">ูุณุชูู 4</option>
                    <option value="5">ูุณุชูู 5</option>
                    <option value="6">ูุณุชูู 6</option>
                    <option value="7">ูุณุชูู 7</option>
                    <option value="8">ูุณุชูู 8</option>
                    <option value="9">ูุณุชูู 9</option>
                    <option value="10">ูุณุชูู 10</option>
                </select>
            </div>
            
            <div class="input-group">
                <label for="dominatorsInfantryLevel">ูุณุชูู ูุดุงุฉ ุงูููููููู</label>
                <select id="dominatorsInfantryLevel">
                    <option value="1">ูุณุชูู 1</option>
                    <option value="2">ูุณุชูู 2</option>
                    <option value="3">ูุณุชูู 3</option>
                    <option value="4">ูุณุชูู 4</option>
                    <option value="5">ูุณุชูู 5</option>
                    <option value="6">ูุณุชูู 6</option>
                    <option value="7">ูุณุชูู 7</option>
                    <option value="8">ูุณุชูู 8</option>
                    <option value="9">ูุณุชูู 9</option>
                    <option value="10">ูุณุชูู 10</option>
                </select>
            </div>
        </div>
        
        <button onclick="compareUnits('infantry')" class="compare-button">ูุงุฑู</button>
        
        <div class="chart-row">
            <div class="chart-column">
                <h3>ูุดุงุฉ ูููููุณ</h3>
                <table id="heliosInfantryTable">
                    <thead>
                        <tr>
                            <th>ุงููุณุชูู</th>
                            <th>ูุฌูู</th>
                            <th>ุฏูุงุน</th>
                            <th>ุตุญุฉ</th>
                            <th>ูุชู</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
            
            <div class="chart-column">
                <h3>ูุดุงุฉ ุงูููููููู</h3>
                <table id="dominatorsInfantryTable">
                    <thead>
                        <tr>
                            <th>ุงููุณุชูู</th>
                            <th>ูุฌูู</th>
                            <th>ุฏูุงุน</th>
                            <th>ุตุญุฉ</th>
                            <th>ูุชู</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
        
        <div id="infantryComparisonResult" class="comparison-result">
            <p>ุงุฎุชุฑ ุงููุณุชููุงุช ูุงููุฑ ุนูู "ูุงุฑู" ูุฑุคูุฉ ุงููุชุงุฆุฌ</p>
        </div>
        
        <div class="chart-container">
            <canvas id="infantryChart"></canvas>
        </div>
    </div>
    
    <!-- Archers Comparison Tab -->
    <div id="archers-comparison" class="tab-content">
        <div class="logo-container">
            <div class="faction-logo">๐น ูููููุณ</div>
            <h2>ููุงุฑูุฉ ุงูุฑูุงุฉ</h2>
            <div class="faction-logo">๐น ุงูููููููู</div>
        </div>
        
        <div class="promotional-message">
            ูุฏุนูู ููุงุดุชุฑุงู ูู ููุงุชูุง ูุฏุนู ุงููุดุฑูุน! Whiteout Survival Comparison ุงููุนุงููุฑ ูุง ุชุดูู ุนุชุงุฏ ุงูุญุงูู.
        </div>
        
        <div class="input-row">
            <div class="input-group">
                <label for="heliosArchersLevel">ูุณุชูู ุฑูุงุฉ ูููููุณ</label>
                <select id="heliosArchersLevel">
                    <option value="1">ูุณุชูู 1</option>
                    <option value="2">ูุณุชูู 2</option>
                    <option value="3">ูุณุชูู 3</option>
                    <option value="4">ูุณุชูู 4</option>
                    <option value="5">ูุณุชูู 5</option>
                    <option value="6">ูุณุชูู 6</option>
                    <option value="7">ูุณุชูู 7</option>
                    <option value="8">ูุณุชูู 8</option>
                    <option value="9">ูุณุชูู 9</option>
                    <option value="10">ูุณุชูู 10</option>
                </select>
            </div>
            
            <div class="input-group">
                <label for="dominatorsArchersLevel">ูุณุชูู ุฑูุงุฉ ุงูููููููู</label>
                <select id="dominatorsArchersLevel">
                    <option value="1">ูุณุชูู 1</option>
                    <option value="2">ูุณุชูู 2</option>
                    <option value="3">ูุณุชูู 3</option>
                    <option value="4">ูุณุชูู 4</option>
                    <option value="5">ูุณุชูู 5</option>
                    <option value="6">ูุณุชูู 6</option>
                    <option value="7">ูุณุชูู 7</option>
                    <option value="8">ูุณุชูู 8</option>
                    <option value="9">ูุณุชูู 9</option>
                    <option value="10">ูุณุชูู 10</option>
                </select>
            </div>
        </div>
        
        <button onclick="compareUnits('archers')" class="compare-button">ูุงุฑู</button>
        
        <div class="chart-row">
            <div class="chart-column">
                <h3>ุฑูุงุฉ ูููููุณ</h3>
                <table id="heliosArchersTable">
                    <thead>
                        <tr>
                            <th>ุงููุณุชูู</th>
                            <th>ูุฌูู</th>
                            <th>ุฏูุงุน</th>
                            <th>ุตุญุฉ</th>
                            <th>ูุชู</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
            
            <div class="chart-column">
                <h3>ุฑูุงุฉ ุงูููููููู</h3>
                <table id="dominatorsArchersTable">
                    <thead>
                        <tr>
                            <th>ุงููุณุชูู</th>
                            <th>ูุฌูู</th>
                            <th>ุฏูุงุน</th>
                            <th>ุตุญุฉ</th>
                            <th>ูุชู</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
        
        <div id="archersComparisonResult" class="comparison-result">
            <p>ุงุฎุชุฑ ุงููุณุชููุงุช ูุงููุฑ ุนูู "ูุงุฑู" ูุฑุคูุฉ ุงููุชุงุฆุฌ</p>
        </div>
        
        <div class="chart-container">
            <canvas id="archersChart"></canvas>
        </div>
    </div>
    
    <!-- Spearmen Comparison Tab -->
    <div id="spearmen-comparison" class="tab-content">
        <div class="logo-container">
            <div class="faction-logo">โ๏ธ ูููููุณ</div>
            <h2>ููุงุฑูุฉ ุงูุฑูุญ</h2>
            <div class="faction-logo">โ๏ธ ุงูููููููู</div>
        </div>
        
        <div class="promotional-message">
            ูุฏุนูู ููุงุดุชุฑุงู ูู ููุงุชูุง ูุฏุนู ุงููุดุฑูุน! Whiteout Survival Comparison ุงููุนุงููุฑ ูุง ุชุดูู ุนุชุงุฏ ุงูุญุงูู.
        </div>
        
        <div class="input-row">
            <div class="input-group">
                <label for="heliosSpearmenLevel">ูุณุชูู ุฑูุญ ูููููุณ</label>
                <select id="heliosSpearmenLevel">
                    <option value="1">ูุณุชูู 1</option>
                    <option value="2">ูุณุชูู 2</option>
                    <option value="3">ูุณุชูู 3</option>
                    <option value="4">ูุณุชูู 4</option>
                    <option value="5">ูุณุชูู 5</option>
                    <option value="6">ูุณุชูู 6</option>
                    <option value="7">ูุณุชูู 7</option>
                    <option value="8">ูุณุชูู 8</option>
                    <option value="9">ูุณุชูู 9</option>
                    <option value="10">ูุณุชูู 10</option>
                </select>
            </div>
            
            <div class="input-group">
                <label for="dominatorsSpearmenLevel">ูุณุชูู ุฑูุญ ุงูููููููู</label>
                <select id="dominatorsSpearmenLevel">
                    <option value="1">ูุณุชูู 1</option>
                    <option value="2">ูุณุชูู 2</option>
                    <option value="3">ูุณุชูู 3</option>
                    <option value="4">ูุณุชูู 4</option>
                    <option value="5">ูุณุชูู 5</option>
                    <option value="6">ูุณุชูู 6</option>
                    <option value="7">ูุณุชูู 7</option>
                    <option value="8">ูุณุชูู 8</option>
                    <option value="9">ูุณุชูู 9</option>
                    <option value="10">ูุณุชูู 10</option>
                </select>
            </div>
        </div>
        
        <button onclick="compareUnits('spearmen')" class="compare-button">ูุงุฑู</button>
        
        <div class="chart-row">
            <div class="chart-column">
                <h3>ุฑูุญ ูููููุณ</h3>
                <table id="heliosSpearmenTable">
                    <thead>
                        <tr>
                            <th>ุงููุณุชูู</th>
                            <th>ูุฌูู</th>
                            <th>ุฏูุงุน</th>
                            <th>ุตุญุฉ</th>
                            <th>ูุชู</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
            
            <div class="chart-column">
                <h3>ุฑูุญ ุงูููููููู</h3>
                <table id="dominatorsSpearmenTable">
                    <thead>
                        <tr>
                            <th>ุงููุณุชูู</th>
                            <th>ูุฌูู</th>
                            <th>ุฏูุงุน</th>
                            <th>ุตุญุฉ</th>
                            <th>ูุชู</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
        
        <div id="spearmenComparisonResult" class="comparison-result">
            <p>ุงุฎุชุฑ ุงููุณุชููุงุช ูุงููุฑ ุนูู "ูุงุฑู" ูุฑุคูุฉ ุงููุชุงุฆุฌ</p>
        </div>
        
        <div class="chart-container">
            <canvas id="spearmenChart"></canvas>
        </div>
    </div>
    
    <!-- Battle Simulation Tab -->
    <div id="battle-simulation" class="tab-content">
        <h2>ูุญุงูุงุฉ ุงููุชุงู</h2>
        
        <div class="promotional-message">
            ูุฏุนูู ููุงุดุชุฑุงู ูู ููุงุชูุง ูุฏุนู ุงููุดุฑูุน! Whiteout Survival Comparison ุงููุนุงููุฑ ูุง ุชุดูู ุนุชุงุฏ ุงูุญุงูู.
        </div>
        

        
        <div class="input-row">
            <div class="army-config helios-config">
                <h3>ุฌูุด ูููููุณ</h3>
                <div class="input-group">
                    <label for="heliosCount">ุนุฏุฏ ุงูููุงุช (ุงูุญุฏ ุงูุฃูุตู: 100,000)</label>
                    <input type="number" id="heliosCount" min="1" max="100000" value="10000">
                </div>
                
                <div class="input-group">
                    <label for="heliosBattleInfantryLevel">ูุณุชูู ุงููุดุงุฉ</label>
                    <select id="heliosBattleInfantryLevel">
                        <option value="1">ูุณุชูู 1</option>
                        <option value="2">ูุณุชูู 2</option>
                        <option value="3">ูุณุชูู 3</option>
                        <option value="4">ูุณุชูู 4</option>
                        <option value="5">ูุณุชูู 5</option>
                        <option value="6">ูุณุชูู 6</option>
                        <option value="7">ูุณุชูู 7</option>
                        <option value="8">ูุณุชูู 8</option>
                        <option value="9">ูุณุชูู 9</option>
                        <option value="10">ูุณุชูู 10</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label for="heliosBattleArchersLevel">ูุณุชูู ุงูุฑูุงุฉ</label>
                    <select id="heliosBattleArchersLevel">
                        <option value="1">ูุณุชูู 1</option>
                        <option value="2">ูุณุชูู 2</option>
                        <option value="3">ูุณุชูู 3</option>
                        <option value="4">ูุณุชูู 4</option>
                        <option value="5">ูุณุชูู 5</option>
                        <option value="6">ูุณุชูู 6</option>
                        <option value="7">ูุณุชูู 7</option>
                        <option value="8">ูุณุชูู 8</option>
                        <option value="9">ูุณุชูู 9</option>
                        <option value="10">ูุณุชูู 10</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label for="heliosBattleSpearmenLevel">ูุณุชูู ุงูุฑูุญ</label>
                    <select id="heliosBattleSpearmenLevel">
                        <option value="1">ูุณุชูู 1</option>
                        <option value="2">ูุณุชูู 2</option>
                        <option value="3">ูุณุชูู 3</option>
                        <option value="4">ูุณุชูู 4</option>
                        <option value="5">ูุณุชูู 5</option>
                        <option value="6">ูุณุชูู 6</option>
                        <option value="7">ูุณุชูู 7</option>
                        <option value="8">ูุณุชูู 8</option>
                        <option value="9">ูุณุชูู 9</option>
                        <option value="10">ูุณุชูู 10</option>
                    </select>
                </div>
                
                <h4>ูุณุจ ุงูููุงุช (ุงููุฌููุน: 100%)</h4>
                <div class="percentage-slider-container">
                    <label for="heliosInfantrySlider">ูุณุจุฉ ุงููุดุงุฉ</label>
                    <input type="range" id="heliosInfantrySlider" min="0" max="100" value="40">
                    <input type="number" id="heliosInfantryPercent" min="0" max="100" value="40">
                </div>
                
                <div class="percentage-slider-container">
                    <label for="heliosArchersSlider">ูุณุจุฉ ุงูุฑูุงุฉ</label>
                    <input type="range" id="heliosArchersSlider" min="0" max="100" value="30">
                    <input type="number" id="heliosArchersPercent" min="0" max="100" value="30">
                </div>
                
                <div class="percentage-slider-container">
                    <label for="heliosSpearmenSlider">ูุณุจุฉ ุงูุฑูุญ</label>
                    <input type="range" id="heliosSpearmenSlider" min="0" max="100" value="30">
                    <input type="number" id="heliosSpearmenPercent" min="0" max="100" value="30">
                </div>
                
                <div id="heliosPercentageTotal" class="percentage-total valid">
                    ุงููุฌููุน: 100%
                </div>
                
                <div class="skills-container">
                    <h4>ุงูููุงุฑุงุช ุงููุชุงููุฉ:</h4>
                    <div id="heliosInfantrySkills"></div>
                    <div id="heliosArchersSkills"></div>
                    <div id="heliosSpearmenSkills"></div>
                </div>
            </div>
            
            <div class="army-config dominant-config">
                <h3>ุฌูุด ุงูููููููู</h3>
                <div class="input-group">
                    <label for="dominatorsCount">ุนุฏุฏ ุงูููุงุช (ุงูุญุฏ ุงูุฃูุตู: 100,000)</label>
                    <input type="number" id="dominatorsCount" min="1" max="100000" value="10000">
                </div>
                
                <div class="input-group">
                    <label for="dominatorsBattleInfantryLevel">ูุณุชูู ุงููุดุงุฉ</label>
                    <select id="dominatorsBattleInfantryLevel">
                        <option value="1">ูุณุชูู 1</option>
                        <option value="2">ูุณุชูู 2</option>
                        <option value="3">ูุณุชูู 3</option>
                        <option value="4">ูุณุชูู 4</option>
                        <option value="5">ูุณุชูู 5</option>
                        <option value="6">ูุณุชูู 6</option>
                        <option value="7">ูุณุชูู 7</option>
                        <option value="8">ูุณุชูู 8</option>
                        <option value="9">ูุณุชูู 9</option>
                        <option value="10">ูุณุชูู 10</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label for="dominatorsBattleArchersLevel">ูุณุชูู ุงูุฑูุงุฉ</label>
                    <select id="dominatorsBattleArchersLevel">
                        <option value="1">ูุณุชูู 1</option>
                        <option value="2">ูุณุชูู 2</option>
                        <option value="3">ูุณุชูู 3</option>
                        <option value="4">ูุณุชูู 4</option>
                        <option value="5">ูุณุชูู 5</option>
                        <option value="6">ูุณุชูู 6</option>
                        <option value="7">ูุณุชูู 7</option>
                        <option value="8">ูุณุชูู 8</option>
                        <option value="9">ูุณุชูู 9</option>
                        <option value="10">ูุณุชูู 10</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label for="dominatorsBattleSpearmenLevel">ูุณุชูู ุงูุฑูุญ</label>
                    <select id="dominatorsBattleSpearmenLevel">
                        <option value="1">ูุณุชูู 1</option>
                        <option value="2">ูุณุชูู 2</option>
                        <option value="3">ูุณุชูู 3</option>
                        <option value="4">ูุณุชูู 4</option>
                        <option value="5">ูุณุชูู 5</option>
                        <option value="6">ูุณุชูู 6</option>
                        <option value="7">ูุณุชูู 7</option>
                        <option value="8">ูุณุชูู 8</option>
                        <option value="9">ูุณุชูู 9</option>
                        <option value="10">ูุณุชูู 10</option>
                    </select>
                </div>
                
                <h4>ูุณุจ ุงูููุงุช (ุงููุฌููุน: 100%)</h4>
                <div class="percentage-slider-container">
                    <label for="dominatorsInfantrySlider">ูุณุจุฉ ุงููุดุงุฉ</label>
                    <input type="range" id="dominatorsInfantrySlider" min="0" max="100" value="40">
                    <input type="number" id="dominatorsInfantryPercent" min="0" max="100" value="40">
                </div>
                
                <div class="percentage-slider-container">
                    <label for="dominatorsArchersSlider">ูุณุจุฉ ุงูุฑูุงุฉ</label>
                    <input type="range" id="dominatorsArchersSlider" min="0" max="100" value="30">
                    <input type="number" id="dominatorsArchersPercent" min="0" max="100" value="30">
                </div>
                
                <div class="percentage-slider-container">
                    <label for="dominatorsSpearmenSlider">ูุณุจุฉ ุงูุฑูุญ</label>
                    <input type="range" id="dominatorsSpearmenSlider" min="0" max="100" value="30">
                    <input type="number" id="dominatorsSpearmenPercent" min="0" max="100" value="30">
                </div>
                
                <div id="dominatorsPercentageTotal" class="percentage-total valid">
                    ุงููุฌููุน: 100%
                </div>
                
                <div class="skills-container">
                    <h4>ุงูููุงุฑุงุช ุงููุชุงููุฉ:</h4>
                    <div id="dominatorsInfantrySkills"></div>
                    <div id="dominatorsArchersSkills"></div>
                    <div id="dominatorsSpearmenSkills"></div>
                </div>
            </div>
        </div>
        
        <div class="input-group">
            <label for="attacker">ุงูููุงุฌู:</label>
            <select id="attacker">
                <option value="helios">ูููููุณ</option>
                <option value="dominators">ุงูููููููู</option>
            </select>
        </div>
        
        <button id="simulateBattleButton" class="compare-button" onclick="simulateBattle()">ูุญุงูุงุฉ ุงููุชุงู</button>
        
        <div id="countdown" class="countdown" style="display: none;">3</div>
        
        <div id="battleResult" class="battle-results" style="display: none;">
            <h3>ูุชูุฌุฉ ุงููุนุฑูุฉ</h3>
            <img id="resultGif" class="result-gif" style="display: none;">
            <div id="battleWinner" class="battle-winner"></div>
            <div id="battleDetails" class="battle-details"></div>
            <div id="battleAnalysis" class="analysis"></div>
            <div class="chart-container">
                <canvas id="battleChart"></canvas>
            </div>
        </div>
    </div>
    
    <!-- Challenge Tab -->
    <div id="challenge" class="tab-content">
        <h2>ูุธุงู ุงูุชุญุฏู</h2>
        
        <div class="promotional-message">
            ูุฏุนูู ููุงุดุชุฑุงู ูู ููุงุชูุง ูุฏุนู ุงููุดุฑูุน! Whiteout Survival Comparison ุงููุนุงููุฑ ูุง ุชุดูู ุนุชุงุฏ ุงูุญุงูู.
        </div>
        
        <!-- Weekly Champion Section -->
        <div class="weekly-champion" id="weeklyChampion">
            <h3>๐ ุจุทู ุงูุฃุณุจูุน</h3>
            <div class="champion-avatar" id="championAvatar">๐</div>
            <h4 id="championName">ูู ูุชู ุชุญุฏูุฏ ุจุทู ุจุนุฏ</h4>
            <div class="champion-stats">
                <div class="stat-item">
                    <div class="stat-number" id="championWins">0</div>
                    <div class="stat-label">ุงูุชุตุงุฑุงุช</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="championServer">----</div>
                    <div class="stat-label">ุงูุณูุฑูุฑ</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="championLevel">-</div>
                    <div class="stat-label">ุงููุณุชูู</div>
                </div>
            </div>
        </div>

        <!-- Player Registration Section -->
        <div class="player-info">
            <h3>ูุนูููุงุช ุงููุงุนุจ</h3>
            <div class="challenge-form">
                <div class="form-group">
                    <label for="playerName">ุงุณู ุงููุชุญุฏู (5 ุฃุญุฑู ูุญุฏ ุฃูุตู):</label>
                    <input type="text" id="playerName" maxlength="5" placeholder="ุงุณูู">
                </div>
                <div class="form-group">
                    <label for="serverNumber">ุฑูู ุงูุณูุฑูุฑ (4 ุฃุฑูุงู):</label>
                    <input type="number" id="serverNumber" min="1" max="9999" placeholder="1234">
                </div>
                <div class="form-group">
                    <button onclick="savePlayerInfo()">ุญูุธ ุงููุนูููุงุช</button>
                </div>
            </div>
        </div>

        <!-- Challenge Creation Section -->
        <div id="challengeCreationSection" style="display: none;">
            <div class="player-info">
                <h3>ุฅูุดุงุก ุชุญุฏู ุฌุฏูุฏ</h3>
                <div class="challenge-form">
                    <div class="form-group">
                        <label for="challengeLevel">ุงููุณุชูู:</label>
                        <select id="challengeLevel" onchange="updateChallengeSkills()">
                            <option value="1">ุงููุณุชูู 1 - ูููููุณ</option>
                            <option value="2">ุงููุณุชูู 2 - ูููููุณ</option>
                            <option value="3">ุงููุณุชูู 3 - ูููููุณ</option>
                            <option value="4">ุงููุณุชูู 4 - ูููููุณ</option>
                            <option value="5">ุงููุณุชูู 5 - ูููููุณ</option>
                            <option value="6">ุงููุณุชูู 6 - ูููููุณ</option>
                            <option value="7">ุงููุณุชูู 7 - ูููููุณ</option>
                            <option value="8">ุงููุณุชูู 8 - ูููููุณ</option>
                            <option value="9">ุงููุณุชูู 9 - ูููููุณ</option>
                            <option value="10">ุงููุณุชูู 10 - ูููููุณ</option>
                            <option value="11">ุงููุณุชูู 1 - ุงูููููููู</option>
                            <option value="12">ุงููุณุชูู 2 - ุงูููููููู</option>
                            <option value="13">ุงููุณุชูู 3 - ุงูููููููู</option>
                            <option value="14">ุงููุณุชูู 4 - ุงูููููููู</option>
                            <option value="15">ุงููุณุชูู 5 - ุงูููููููู</option>
                            <option value="16">ุงููุณุชูู 6 - ุงูููููููู</option>
                            <option value="17">ุงููุณุชูู 7 - ุงูููููููู</option>
                            <option value="18">ุงููุณุชูู 8 - ุงูููููููู</option>
                            <option value="19">ุงููุณุชูู 9 - ุงูููููููู</option>
                            <option value="20">ุงููุณุชูู 10 - ุงูููููููู</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="challengeRole">ุงูุฏูุฑ:</label>
                        <select id="challengeRole">
                            <option value="attacker">ููุงุฌู</option>
                            <option value="defender">ูุฏุงูุน</option>
                        </select>
                    </div>
                </div>

                <!-- Level Skills Display -->
                <div id="challengeSkills" class="level-skills"></div>

                <!-- Army Composition -->
                <div class="army-composition">
                    <h4>ุชุดูููุฉ ุงูุฌูุด (ุงููุฌููุน 100%)</h4>
                    <div class="composition-row">
                        <div class="composition-label">ุงููุดุงุฉ:</div>
                        <input type="range" class="composition-slider" id="challengeInfantrySlider" min="0" max="100" value="50" oninput="updateChallengeComposition()">
                        <div class="composition-value" id="challengeInfantryValue">50%</div>
                    </div>
                    <div class="composition-row">
                        <div class="composition-label">ุงูุฑูุงุฉ:</div>
                        <input type="range" class="composition-slider" id="challengeArcherSlider" min="0" max="100" value="30" oninput="updateChallengeComposition()">
                        <div class="composition-value" id="challengeArcherValue">30%</div>
                    </div>
                    <div class="composition-row">
                        <div class="composition-label">ุงูุฑูุญ:</div>
                        <input type="range" class="composition-slider" id="challengeLancerSlider" min="0" max="100" value="20" oninput="updateChallengeComposition()">
                        <div class="composition-value" id="challengeLancerValue">20%</div>
                    </div>
                    <div class="composition-row">
                        <strong>ุงููุฌููุน: <span id="challengeCompositionTotal">100%</span></strong>
                    </div>
                    <div class="composition-row">
                        <div style="font-size: 14px; color: #666; margin-top: 10px;">
                            ุฃุนุฏุงุฏ ุงูููุงุช (ูู ุฅุฌูุงูู 100,000):
                            <div>ุงููุดุงุฉ: <span id="challengeInfantryCount">50,000</span></div>
                            <div>ุงูุฑูุงุฉ: <span id="challengeArcherCount">30,000</span></div>
                            <div>ุงูุฑูุญ: <span id="challengeLancerCount">20,000</span></div>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <button onclick="createChallenge()" id="createChallengeBtn">ุชุญุฏู ุจุงูุชุธุงุฑ ุงูุฎุตู</button>
                </div>
            </div>
        </div>

        <!-- Challenge Waiting Message -->
        <div id="challengeWaiting" class="challenge-waiting" style="display: none;">
            <h3>โณ ูู ุงูุชุธุงุฑ ุฎุตู ููุงูุถูุงู ุฅูู ุงูุชุญุฏู...</h3>
            <p>ุชู ุฅูุดุงุก ุชุญุฏูู ุจูุฌุงุญ! ุณูุธูุฑ ุชุญุฏูู ูู ูุงุฆูุฉ ุงูุชุญุฏูุงุช ุงููุชุงุญุฉ ููุงุนุจูู ุงูุขุฎุฑูู.</p>
            <button onclick="cancelChallenge()">ุฅูุบุงุก ุงูุชุญุฏู</button>
        </div>

        <!-- Available Challenges List -->
        <div class="challenge-list">
            <h3>ุงูุชุญุฏูุงุช ุงููุชุงุญุฉ</h3>
            <div style="background-color: #e3f2fd; padding: 10px; border-radius: 5px; margin-bottom: 15px; border-right: 3px solid #2196f3;">
                <p style="margin: 0; font-size: 14px; color: #0d47a1;">
                    โน๏ธ ุนูุฏ ูุจูู ุฃู ุชุญุฏูุ ุณููุทูุจ ููู ุชุณุฌูู ุงุณูู ูุฑูู ุณูุฑูุฑู ูููุดุงุฑูุฉ ูู ุงููุนุฑูุฉ
                </p>
            </div>
            <div id="challengesList">
                <p style="text-align: center; color: #666; padding: 20px;">ูุง ุชูุฌุฏ ุชุญุฏูุงุช ูุชุงุญุฉ ุญุงููุงู</p>
            </div>
        </div>

        <!-- Battle Preparation Section -->
        <div id="battlePreparation" class="battle-preparation" style="display: none;">
            <h3>ุงูุงุณุชุนุฏุงุฏ ูููุนุฑูุฉ</h3>
            <div class="vs-indicator" id="vsIndicator">
                <span id="challenger1Name">ุงููุงุนุจ 1</span> VS <span id="challenger2Name">ุงููุงุนุจ 2</span>
            </div>
            
            <div class="input-row">
                <div class="army-config helios-config" id="challenger1Info">
                    <h4 id="challenger1Title">ุงููุชุญุฏู ุงูุฃูู</h4>
                    <div id="challenger1Details"></div>
                </div>
                
                <div class="army-config dominant-config" id="challenger2Config">
                    <h4>ุชุดูููุฉ ุงููุชุญุฏู ุงูุซุงูู</h4>
                    <div class="army-composition">
                        <div class="composition-row">
                            <div class="composition-label">ุงููุดุงุฉ:</div>
                            <input type="range" class="composition-slider" id="defender2InfantrySlider" min="0" max="100" value="50" oninput="updateDefender2Composition()">
                            <div class="composition-value" id="defender2InfantryValue">50%</div>
                        </div>
                        <div class="composition-row">
                            <div class="composition-label">ุงูุฑูุงุฉ:</div>
                            <input type="range" class="composition-slider" id="defender2ArcherSlider" min="0" max="100" value="30" oninput="updateDefender2Composition()">
                            <div class="composition-value" id="defender2ArcherValue">30%</div>
                        </div>
                        <div class="composition-row">
                            <div class="composition-label">ุงูุฑูุญ:</div>
                            <input type="range" class="composition-slider" id="defender2LancerSlider" min="0" max="100" value="20" oninput="updateDefender2Composition()">
                            <div class="composition-value" id="defender2LancerValue">20%</div>
                        </div>
                        <div class="composition-row">
                            <strong>ุงููุฌููุน: <span id="defender2CompositionTotal">100%</span></strong>
                        </div>
                    </div>
                </div>
            </div>

            <div class="form-group" style="text-align: center;">
                <button onclick="startChallengeBattle()" style="background-color: #e74c3c; font-size: 18px; padding: 15px 30px;">ุจุฏุก ุงููุนุฑูุฉ!</button>
            </div>
        </div>

        <!-- Challenge Battle Results -->
        <div id="challengeBattleResults" class="battle-results" style="display: none;">
        </div>

        <!-- Comments Section -->
        <div class="comments-section">
            <h3>๐ฌ ุงูุชุนูููุงุช ูุงูุขุฑุงุก</h3>
            
            <div class="comments-counter">
                <i class="fas fa-comments"></i>
                <span id="commentsCount">0</span>
                <span>ุชุนููู</span>
            </div>

            <div class="comment-form">
                <h4>ุฃุถู ุชุนูููู:</h4>
                <div class="form-group">
                    <label for="commentAuthor">ุงูุงุณู:</label>
                    <input type="text" id="commentAuthor" placeholder="ุงุณูู" maxlength="20">
                </div>
                <div class="form-group">
                    <label for="commentText">ุงูุชุนููู:</label>
                    <textarea id="commentText" class="comment-input" placeholder="ุดุงุฑู ุฑุฃูู ุญูู ุงููุนุฑูุฉ ุฃู ุงููููุน..." maxlength="500"></textarea>
                </div>
                <button onclick="addComment()" style="background-color: #17a2b8;">
                    <i class="fas fa-paper-plane"></i> ุฅุฑุณุงู ุงูุชุนููู
                </button>
            </div>

            <div id="commentsList">
                <!-- ุงูุชุนูููุงุช ุณุชุธูุฑ ููุง -->
            </div>
        </div>
    </div>
    
    <div class="credits">
        ุญููู ูุชุตููู: <a href="https://t.me/fulldesigne" target="_blank">https://t.me/fulldesigne</a> ูู ูุง ุชุญุชุงุฌู ูู ุนุงูู ุงูุชุตููู ูุงูุฌุฑุงููู
    </div>
    
    <div class="footer">
        <p>ุงุดุชุฑู ูุฏุนู ุงููุดุฑูุน:</p>
        <a href="https://www.youtube.com/@whiteoutsurvivel" target="_blank">ููุงุฉ ููุชููุจ</a> |
        <a href="https://discord.gg/9p2DZsz9" target="_blank">ุงูุถู ุฅูููุง ุนูู ุฏูุณููุฑุฏ</a>
    </div>
</div>

<script>
    // Unit statistics data
    const unitStats = {
        heliosInfantry: {
            attack: [13, 14, 15, 15, 16, 17, 17, 18, 18, 19],
            defense: [16, 17, 18, 19, 22, 23, 24, 25, 27, 28],
            health: [18, 19, 20, 21, 22, 23, 24, 25, 26, 27],
            lethality: [12, 13, 14, 15, 15, 16, 16, 17, 17, 18]
        },
        heliosArchers: {
            attack: [17, 19, 20, 21, 23, 24, 25, 26, 28, 30],
            defense: [13, 14, 15, 16, 16, 17, 18, 19, 19, 21],
            health: [13, 14, 15, 15, 16, 16, 17, 18, 18, 20],
            lethality: [18, 19, 20, 21, 22, 23, 24, 25, 26, 27]
        },
        heliosSpearmen: {
            attack: [16, 18, 19, 20, 21, 22, 23, 24, 25, 26],
            defense: [14, 15, 16, 16, 17, 17, 18, 19, 19, 21],
            health: [13, 14, 15, 15, 16, 16, 17, 17, 18, 20],
            lethality: [17, 18, 19, 20, 22, 23, 24, 25, 27, 28]
        },
        dominatorsInfantry: {
            attack: [11, 12, 13, 13, 14, 14, 15, 15, 16, 18],
            defense: [14, 16, 17, 18, 20, 21, 22, 23, 25, 26],
            health: [16, 17, 18, 19, 20, 21, 22, 23, 24, 25],
            lethality: [10, 11, 12, 13, 13, 13, 14, 15, 15, 16]
        },
        dominatorsArchers: {
            attack: [15, 17, 18, 19, 21, 22, 23, 24, 26, 27],
            defense: [11, 12, 13, 14, 14, 15, 15, 16, 17, 19],
            health: [11, 12, 13, 13, 14, 14, 15, 15, 16, 17],
            lethality: [16, 17, 18, 19, 20, 21, 22, 23, 24, 25]
        },
        dominatorsSpearmen: {
            attack: [14, 16, 17, 18, 20, 21, 22, 23, 25, 26],
            defense: [12, 13, 14, 14, 15, 15, 16, 17, 17, 19],
            health: [11, 12, 13, 13, 14, 14, 15, 15, 16, 17],
            lethality: [15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
        }
    };
    
    // Battle skills data
    const battleSkills = {
        infantry: {
            common: [
                { name: "ุณูุฏ ุงูุดุฌุนุงู", description: "+10% ุถุฑุฑ ุถุฏ ุฑูุงุฉ ุงูุฑูุญ" },
                { name: "ุฏุนุงูุงุช ูููุงุฐูุฉ", description: "+10% ุฏูุงุน ุถุฏ ุฑูุงุฉ ุงูุฑูุญ" }
            ],
            levelBased: {
                3: { name: "ูุฑูุณุชุงู ูุงุฑู", description: "ุชูููู 25% ูู ุงูุถุฑุฑ" },
                5: { name: "ูุฑูุณุชุงู ุฃููู", description: "ุชูููู 35% ูู ุงูุถุฑุฑ" },
                8: { name: "ุฌุณู ุงูุถูุก", description: "+4% ุฏูุงุนุ -10% ุถุฑุฑ" },
                10: { name: "ุฌุณู ุงูุถูุก II", description: "+6% ุฏูุงุนุ -15% ุถุฑุฑ" }
            }
        },
        spearmen: {
            common: [
                { name: "ุงูุงูุฏูุงุน", description: "+10% ุถุฏ ุฑูุงุฉ ุงูุฑูุญ" },
                { name: "ุงููุชุฑุจุต", description: "ูุฑุตุฉ 20% ูุชุฌุงูุฒ ุงูุตู ุงูุฃูุงูู" }
            ]
        },
        archers: {
            common: [
                { name: "ุถุฑุจุฉ ุจุนูุฏุฉ ุงููุฏู", description: "+10% ุถุฑุฑ ุถุฏ ุงููุดุงุฉ" }
            ]
        }
    };
    
    // Chart objects to manage chart instances
    const chartObjects = {};
    
    // DOM ready
    document.addEventListener('DOMContentLoaded', function() {
        // Initialize tabs
        initTabs();
        
        // Populate tables with unit data
        populateUnitTables();
        
        // Setup percentage sliders
        setupPercentageSliders('helios');
        setupPercentageSliders('dominators');
        setupPercentageSliders('challenge');
        
        // Update battle skills display
        updateBattleSkills();
    });
    
    // Initialize tabs
    function initTabs() {
        const tabButtons = document.querySelectorAll('.tab-button');
        
        tabButtons.forEach(button => {
            button.addEventListener('click', function() {
                const tabId = this.getAttribute('data-tab');
                
                // Remove active class from all buttons and content
                document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(content => content.style.display = 'none');
                
                // Add active class to current button and show content
                this.classList.add('active');
                document.getElementById(tabId).style.display = 'block';
            });
        });
    }
    
    // Populate unit tables with data
    function populateUnitTables() {
        populateUnitTable('heliosInfantryTable', unitStats.heliosInfantry);
        populateUnitTable('dominatorsInfantryTable', unitStats.dominatorsInfantry);
        populateUnitTable('heliosArchersTable', unitStats.heliosArchers);
        populateUnitTable('dominatorsArchersTable', unitStats.dominatorsArchers);
        populateUnitTable('heliosSpearmenTable', unitStats.heliosSpearmen);
        populateUnitTable('dominatorsSpearmenTable', unitStats.dominatorsSpearmen);
    }
    
    // Helper function to populate a unit table
    function populateUnitTable(tableId, stats) {
        const table = document.getElementById(tableId);
        if (table) {
            const tbody = table.querySelector('tbody');
            if (tbody) {
                tbody.innerHTML = '';
                
                for (let level = 0; level < 10; level++) {
                    const tr = document.createElement('tr');
                    
                    // Level column
                    const tdLevel = document.createElement('td');
                    tdLevel.textContent = level + 1;
                    tr.appendChild(tdLevel);
                    
                    // Attack column
                    const tdAttack = document.createElement('td');
                    tdAttack.textContent = stats.attack[level];
                    tr.appendChild(tdAttack);
                    
                    // Defense column
                    const tdDefense = document.createElement('td');
                    tdDefense.textContent = stats.defense[level];
                    tr.appendChild(tdDefense);
                    
                    // Health column
                    const tdHealth = document.createElement('td');
                    tdHealth.textContent = stats.health[level];
                    tr.appendChild(tdHealth);
                    
                    // Lethality column
                    const tdLethality = document.createElement('td');
                    tdLethality.textContent = stats.lethality[level];
                    tr.appendChild(tdLethality);
                    
                    tbody.appendChild(tr);
                }
            }
        }
    }
    
    // Compare units
    function compareUnits(unitType) {
        const heliosLevel = parseInt(document.getElementById(`helios${capitalizeFirstLetter(unitType)}Level`).value);
        const dominatorsLevel = parseInt(document.getElementById(`dominators${capitalizeFirstLetter(unitType)}Level`).value);
        
        // Get unit stats
        const heliosStats = {
            attack: unitStats[`helios${capitalizeFirstLetter(unitType)}`].attack[heliosLevel - 1],
            defense: unitStats[`helios${capitalizeFirstLetter(unitType)}`].defense[heliosLevel - 1],
            health: unitStats[`helios${capitalizeFirstLetter(unitType)}`].health[heliosLevel - 1],
            lethality: unitStats[`helios${capitalizeFirstLetter(unitType)}`].lethality[heliosLevel - 1],
            level: heliosLevel
        };
        
        const dominatorsStats = {
            attack: unitStats[`dominators${capitalizeFirstLetter(unitType)}`].attack[dominatorsLevel - 1],
            defense: unitStats[`dominators${capitalizeFirstLetter(unitType)}`].defense[dominatorsLevel - 1],
            health: unitStats[`dominators${capitalizeFirstLetter(unitType)}`].health[dominatorsLevel - 1],
            lethality: unitStats[`dominators${capitalizeFirstLetter(unitType)}`].lethality[dominatorsLevel - 1],
            level: dominatorsLevel
        };
        
        // Calculate power using the formula: power = (attack ร 0.35) + (defense ร 0.25) + (health ร 0.2) + (lethality ร 0.2)
        const heliosPower = calculatePower(heliosStats);
        const dominatorsPower = calculatePower(dominatorsStats);
        
        // Update comparison results
        updateComparisonResults(unitType, heliosStats, dominatorsStats, heliosPower, dominatorsPower);
        
        // Draw comparison chart
        drawComparisonChart(unitType, heliosStats, dominatorsStats);
    }
    
    // Calculate unit power
    function calculatePower(stats) {
        return (stats.attack * 0.35) + (stats.defense * 0.25) + (stats.health * 0.2) + (stats.lethality * 0.2);
    }
    
    // Update comparison results
    function updateComparisonResults(unitType, heliosStats, dominatorsStats, heliosPower, dominatorsPower) {
        const resultElement = document.getElementById(`${unitType}ComparisonResult`);
        if (!resultElement) return;
        
        const powerDiff = Math.abs(heliosPower - dominatorsPower);
        const powerRatio = (powerDiff / Math.min(heliosPower, dominatorsPower) * 100).toFixed(1);
        
        // Create result HTML
        let resultHTML = '';
        
        if (heliosPower > dominatorsPower) {
            resultHTML += `<h3>ููุฉ ูููููุณ ุฃุนูู ุจูุณุจุฉ ${powerRatio}%</h3>`;
            resultHTML += `<p>ููุฉ ูููููุณ: <strong>${heliosPower.toFixed(2)}</strong></p>`;
            resultHTML += `<p>ููุฉ ุงูููููููู: <strong>${dominatorsPower.toFixed(2)}</strong></p>`;
            
            // Add stat comparison
            resultHTML += '<div class="stat-comparison">';
            resultHTML += `<p>ูุฌูู: ${heliosStats.attack} ููุงุจู ${dominatorsStats.attack} (${heliosStats.attack > dominatorsStats.attack ? '+' : ''}${heliosStats.attack - dominatorsStats.attack})</p>`;
            resultHTML += `<p>ุฏูุงุน: ${heliosStats.defense} ููุงุจู ${dominatorsStats.defense} (${heliosStats.defense > dominatorsStats.defense ? '+' : ''}${heliosStats.defense - dominatorsStats.defense})</p>`;
            resultHTML += `<p>ุตุญุฉ: ${heliosStats.health} ููุงุจู ${dominatorsStats.health} (${heliosStats.health > dominatorsStats.health ? '+' : ''}${heliosStats.health - dominatorsStats.health})</p>`;
            resultHTML += `<p>ูุชู: ${heliosStats.lethality} ููุงุจู ${dominatorsStats.lethality} (${heliosStats.lethality > dominatorsStats.lethality ? '+' : ''}${heliosStats.lethality - dominatorsStats.lethality})</p>`;
            resultHTML += '</div>';
        } else if (dominatorsPower > heliosPower) {
            resultHTML += `<h3>ููุฉ ุงูููููููู ุฃุนูู ุจูุณุจุฉ ${powerRatio}%</h3>`;
            resultHTML += `<p>ููุฉ ุงูููููููู: <strong>${dominatorsPower.toFixed(2)}</strong></p>`;
            resultHTML += `<p>ููุฉ ูููููุณ: <strong>${heliosPower.toFixed(2)}</strong></p>`;
            
            // Add stat comparison
            resultHTML += '<div class="stat-comparison">';
            resultHTML += `<p>ูุฌูู: ${dominatorsStats.attack} ููุงุจู ${heliosStats.attack} (${dominatorsStats.attack > heliosStats.attack ? '+' : ''}${dominatorsStats.attack - heliosStats.attack})</p>`;
            resultHTML += `<p>ุฏูุงุน: ${dominatorsStats.defense} ููุงุจู ${heliosStats.defense} (${dominatorsStats.defense > heliosStats.defense ? '+' : ''}${dominatorsStats.defense - heliosStats.defense})</p>`;
            resultHTML += `<p>ุตุญุฉ: ${dominatorsStats.health} ููุงุจู ${heliosStats.health} (${dominatorsStats.health > heliosStats.health ? '+' : ''}${dominatorsStats.health - heliosStats.health})</p>`;
            resultHTML += `<p>ูุชู: ${dominatorsStats.lethality} ููุงุจู ${heliosStats.lethality} (${dominatorsStats.lethality > heliosStats.lethality ? '+' : ''}${dominatorsStats.lethality - heliosStats.lethality})</p>`;
            resultHTML += '</div>';
        } else {
            resultHTML += '<h3>ุงูููุชุงู ูุชุณุงููุชุงู</h3>';
            resultHTML += `<p>ููุฉ ูููููุณ ูุงูููููููู: <strong>${heliosPower.toFixed(2)}</strong></p>`;
        }
        
        resultElement.innerHTML = resultHTML;
        resultElement.style.display = 'block';
    }
    
    // Draw comparison chart
    function drawComparisonChart(unitType, heliosStats, dominatorsStats) {
        const ctx = document.getElementById(`${unitType}Chart`);
        if (!ctx) return;
        
        // Destroy existing chart if it exists
        if (chartObjects[unitType]) {
            try {
                chartObjects[unitType].destroy();
            } catch (e) {
                console.log(`Error destroying ${unitType} chart:`, e);
            }
        }
        
        // Create new chart
        chartObjects[unitType] = new Chart(ctx, {
            type: 'radar',
            data: {
                labels: ['ูุฌูู', 'ุฏูุงุน', 'ุตุญุฉ', 'ูุชู'],
                datasets: [
                    {
                        label: `ูููููุณ (ูุณุชูู ${heliosStats.level})`,
                        data: [heliosStats.attack, heliosStats.defense, heliosStats.health, heliosStats.lethality],
                        backgroundColor: 'rgba(244, 67, 54, 0.2)',
                        borderColor: 'rgba(244, 67, 54, 1)',
                        pointBackgroundColor: 'rgba(244, 67, 54, 1)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgba(244, 67, 54, 1)',
                        borderWidth: 1
                    },
                    {
                        label: `ุงูููููููู (ูุณุชูู ${dominatorsStats.level})`,
                        data: [dominatorsStats.attack, dominatorsStats.defense, dominatorsStats.health, dominatorsStats.lethality],
                        backgroundColor: 'rgba(255, 193, 7, 0.2)',
                        borderColor: 'rgba(255, 193, 7, 1)',
                        pointBackgroundColor: 'rgba(255, 193, 7, 1)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgba(255, 193, 7, 1)',
                        borderWidth: 1
                    }
                ]
            },
            options: {
                scales: {
                    r: {
                        beginAtZero: true,
                        ticks: {
                            display: false
                        }
                    }
                }
            }
        });
    }
    
    // Setup percentage sliders
    function setupPercentageSliders(faction) {
        const infantrySlider = document.getElementById(`${faction}InfantrySlider`);
        const archersSlider = document.getElementById(`${faction}ArchersSlider`);
        const spearmenSlider = document.getElementById(`${faction}SpearmenSlider`);
        
        const infantryInput = document.getElementById(`${faction}InfantryPercent`);
        const archersInput = document.getElementById(`${faction}ArchersPercent`);
        const spearmenInput = document.getElementById(`${faction}SpearmenPercent`);
        
        if (infantrySlider && archersSlider && spearmenSlider) {
            // Add event listeners to sliders
            infantrySlider.addEventListener('input', () => balancePercentages(faction, 'infantry'));
            archersSlider.addEventListener('input', () => balancePercentages(faction, 'archers'));
            spearmenSlider.addEventListener('input', () => balancePercentages(faction, 'spearmen'));
            
            // Add event listeners to numeric inputs
            infantryInput.addEventListener('input', () => updateFromNumberInput(faction, 'infantry'));
            archersInput.addEventListener('input', () => updateFromNumberInput(faction, 'archers'));
            spearmenInput.addEventListener('input', () => updateFromNumberInput(faction, 'spearmen'));
            
            // Initialize percentages
            updatePercentageDisplay(faction);
        }
    }
    
    // Balance percentages to ensure they sum to 100%
    function balancePercentages(faction, changedUnit) {
        const infantry = document.getElementById(`${faction}InfantrySlider`);
        const archers = document.getElementById(`${faction}ArchersSlider`);
        const spearmen = document.getElementById(`${faction}SpearmenSlider`);
        
        const infantryVal = parseInt(infantry.value);
        const archersVal = parseInt(archers.value);
        const spearmenVal = parseInt(spearmen.value);
        
        const total = infantryVal + archersVal + spearmenVal;
        
        // If total is not 100%, adjust other values
        if (total !== 100) {
            const diff = 100 - total;
            
            if (changedUnit === 'infantry') {
                // Distribute the difference between archers and spearmen
                const archersRatio = archersVal / (archersVal + spearmenVal || 1);
                const newArchersVal = Math.max(0, Math.min(100, archersVal + Math.round(diff * archersRatio)));
                const newSpearmenVal = 100 - infantryVal - newArchersVal;
                
                archers.value = newArchersVal;
                spearmen.value = newSpearmenVal;
            } else if (changedUnit === 'archers') {
                // Distribute the difference between infantry and spearmen
                const infantryRatio = infantryVal / (infantryVal + spearmenVal || 1);
                const newInfantryVal = Math.max(0, Math.min(100, infantryVal + Math.round(diff * infantryRatio)));
                const newSpearmenVal = 100 - newInfantryVal - archersVal;
                
                infantry.value = newInfantryVal;
                spearmen.value = newSpearmenVal;
            } else if (changedUnit === 'spearmen') {
                // Distribute the difference between infantry and archers
                const infantryRatio = infantryVal / (infantryVal + archersVal || 1);
                const newInfantryVal = Math.max(0, Math.min(100, infantryVal + Math.round(diff * infantryRatio)));
                const newArchersVal = 100 - newInfantryVal - spearmenVal;
                
                infantry.value = newInfantryVal;
                archers.value = newArchersVal;
            }
        }
        
        // Update numeric input fields
        document.getElementById(`${faction}InfantryPercent`).value = infantry.value;
        document.getElementById(`${faction}ArchersPercent`).value = archers.value;
        document.getElementById(`${faction}SpearmenPercent`).value = spearmen.value;
        
        // Update the percentage display
        updatePercentageDisplay(faction);
    }
    
    // Update from number input
    function updateFromNumberInput(faction, changedUnit) {
        const input = document.getElementById(`${faction}${capitalizeFirstLetter(changedUnit)}Percent`);
        const slider = document.getElementById(`${faction}${capitalizeFirstLetter(changedUnit)}Slider`);
        
        // Ensure value is within 0-100 range
        let value = parseInt(input.value) || 0;
        value = Math.max(0, Math.min(100, value));
        
        // Update slider value
        slider.value = value;
        input.value = value;
        
        // Balance other percentages
        balancePercentages(faction, changedUnit);
    }
    
    // Update percentage display
    function updatePercentageDisplay(faction) {
        const infantry = parseInt(document.getElementById(`${faction}InfantrySlider`).value);
        const archers = parseInt(document.getElementById(`${faction}ArchersSlider`).value);
        const spearmen = parseInt(document.getElementById(`${faction}SpearmenSlider`).value);
        
        const total = infantry + archers + spearmen;
        
        const totalElement = document.getElementById(`${faction}PercentageTotal`);
        if (totalElement) {
            totalElement.textContent = `ุงููุฌููุน: ${total}%`;
            
            if (total === 100) {
                totalElement.classList.add('valid');
                totalElement.classList.remove('invalid');
                
                // Enable battle simulation button if both factions have valid percentages
                if (faction === 'helios' || faction === 'dominators') {
                    const heliosTotalElement = document.getElementById('heliosPercentageTotal');
                    const dominatorsTotalElement = document.getElementById('dominatorsPercentageTotal');
                    const simulateButton = document.getElementById('simulateBattleButton');
                    
                    if (simulateButton && heliosTotalElement && dominatorsTotalElement &&
                        heliosTotalElement.classList.contains('valid') &&
                        dominatorsTotalElement.classList.contains('valid')) {
                        simulateButton.disabled = false;
                    }
                } else if (faction === 'challenge') {
                    document.getElementById('startChallengeButton').disabled = false;
                }
            } else {
                totalElement.classList.add('invalid');
                totalElement.classList.remove('valid');
                
                if (faction === 'helios' || faction === 'dominators') {
                    document.getElementById('simulateBattleButton').disabled = true;
                } else if (faction === 'challenge') {
                    document.getElementById('startChallengeButton').disabled = true;
                }
            }
        }
    }
    
    // Update battle skills display
    function updateBattleSkills() {
        // Update Helios skills
        updateFactionSkills('helios');
        
        // Update Dominators skills
        updateFactionSkills('dominators');
        
        // Add event listeners to level selectors
        document.getElementById('heliosBattleInfantryLevel').addEventListener('change', () => updateFactionSkills('helios'));
        document.getElementById('heliosBattleArchersLevel').addEventListener('change', () => updateFactionSkills('helios'));
        document.getElementById('heliosBattleSpearmenLevel').addEventListener('change', () => updateFactionSkills('helios'));
        
        document.getElementById('dominatorsBattleInfantryLevel').addEventListener('change', () => updateFactionSkills('dominators'));
        document.getElementById('dominatorsBattleArchersLevel').addEventListener('change', () => updateFactionSkills('dominators'));
        document.getElementById('dominatorsBattleSpearmenLevel').addEventListener('change', () => updateFactionSkills('dominators'));
    }
    
    // Update faction skills
    function updateFactionSkills(faction) {
        const infantryLevel = parseInt(document.getElementById(`${faction}BattleInfantryLevel`).value);
        const archersLevel = parseInt(document.getElementById(`${faction}BattleArchersLevel`).value);
        const spearmenLevel = parseInt(document.getElementById(`${faction}BattleSpearmenLevel`).value);
        
        // Update infantry skills
        updateUnitSkills(faction, 'infantry', infantryLevel);
        
        // Update archers skills
        updateUnitSkills(faction, 'archers', archersLevel);
        
        // Update spearmen skills
        updateUnitSkills(faction, 'spearmen', spearmenLevel);
    }
    
    // Update unit skills
    function updateUnitSkills(faction, unitType, level) {
        const skillsContainer = document.getElementById(`${faction}${capitalizeFirstLetter(unitType)}Skills`);
        if (!skillsContainer) return;
        
        let skillsHTML = `<h5>${capitalizeFirstLetter(unitType)} (ูุณุชูู ${level}):</h5>`;
        
        // Add common skills
        if (battleSkills[unitType] && battleSkills[unitType].common) {
            battleSkills[unitType].common.forEach(skill => {
                skillsHTML += `<span class="skill-badge">${skill.name}: ${skill.description}</span>`;
            });
        }
        
        // Add level-based skills
        if (battleSkills[unitType] && battleSkills[unitType].levelBased) {
            for (let skillLevel in battleSkills[unitType].levelBased) {
                if (level >= parseInt(skillLevel)) {
                    const skill = battleSkills[unitType].levelBased[skillLevel];
                    skillsHTML += `<span class="skill-badge">${skill.name} (ูุณุชูู ${skillLevel}): ${skill.description}</span>`;
                }
            }
        }
        
        skillsContainer.innerHTML = skillsHTML;
    }
    
    // Simulate battle
    function simulateBattle() {
        // Show countdown
        const countdownElement = document.getElementById('countdown');
        countdownElement.style.display = 'block';
        
        let count = 3;
        countdownElement.textContent = count;
        
        const countdownInterval = setInterval(() => {
            count--;
            if (count <= 0) {
                clearInterval(countdownInterval);
                countdownElement.style.display = 'none';
                calculateBattleResult();
            } else {
                countdownElement.textContent = count;
            }
        }, 1000);
    }
    
    // Calculate battle result
    function calculateBattleResult() {
        // Get input values
        const heliosCount = parseInt(document.getElementById('heliosCount').value) || 0;
        const dominatorsCount = parseInt(document.getElementById('dominatorsCount').value) || 0;
        
        // Get unit percentages
        const heliosInfantryPercent = parseInt(document.getElementById('heliosInfantryPercent').value) || 0;
        const heliosArchersPercent = parseInt(document.getElementById('heliosArchersPercent').value) || 0;
        const heliosSpearmenPercent = parseInt(document.getElementById('heliosSpearmenPercent').value) || 0;
        
        const dominatorsInfantryPercent = parseInt(document.getElementById('dominatorsInfantryPercent').value) || 0;
        const dominatorsArchersPercent = parseInt(document.getElementById('dominatorsArchersPercent').value) || 0;
        const dominatorsSpearmenPercent = parseInt(document.getElementById('dominatorsSpearmenPercent').value) || 0;
        
        // Get unit levels
        const heliosInfantryLevel = parseInt(document.getElementById('heliosBattleInfantryLevel').value) || 1;
        const heliosArchersLevel = parseInt(document.getElementById('heliosBattleArchersLevel').value) || 1;
        const heliosSpearmenLevel = parseInt(document.getElementById('heliosBattleSpearmenLevel').value) || 1;
        
        const dominatorsInfantryLevel = parseInt(document.getElementById('dominatorsBattleInfantryLevel').value) || 1;
        const dominatorsArchersLevel = parseInt(document.getElementById('dominatorsBattleArchersLevel').value) || 1;
        const dominatorsSpearmenLevel = parseInt(document.getElementById('dominatorsBattleSpearmenLevel').value) || 1;
        
        // Get attacker
        const attacker = document.getElementById('attacker').value;
        
        // Get unit stats
        const heliosInfantryStats = getUnitStats('helios', 'infantry', heliosInfantryLevel);
        const heliosArchersStats = getUnitStats('helios', 'archers', heliosArchersLevel);
        const heliosSpearmenStats = getUnitStats('helios', 'spearmen', heliosSpearmenLevel);
        
        const dominatorsInfantryStats = getUnitStats('dominators', 'infantry', dominatorsInfantryLevel);
        const dominatorsArchersStats = getUnitStats('dominators', 'archers', dominatorsArchersLevel);
        const dominatorsSpearmenStats = getUnitStats('dominators', 'spearmen', dominatorsSpearmenLevel);
        
        // Apply battle skills
        const heliosInfantryModified = applyBattleSkills('helios', 'infantry', heliosInfantryStats, heliosInfantryLevel, dominatorsSpearmenStats);
        const heliosArchersModified = applyBattleSkills('helios', 'archers', heliosArchersStats, heliosArchersLevel, dominatorsInfantryStats);
        const heliosSpearmenModified = applyBattleSkills('helios', 'spearmen', heliosSpearmenStats, heliosSpearmenLevel, dominatorsArchersStats);
        
        const dominatorsInfantryModified = applyBattleSkills('dominators', 'infantry', dominatorsInfantryStats, dominatorsInfantryLevel, heliosSpearmenStats);
        const dominatorsArchersModified = applyBattleSkills('dominators', 'archers', dominatorsArchersStats, dominatorsArchersLevel, heliosInfantryStats);
        const dominatorsSpearmenModified = applyBattleSkills('dominators', 'spearmen', dominatorsSpearmenStats, dominatorsSpearmenLevel, heliosArchersStats);
        
        // Calculate damage using the formula: Damage = (Attack ร (1 + Lethality / 100)) - (Defense ร 0.5)
        const heliosInfantryDamage = calculateDamage(heliosInfantryModified, dominatorsInfantryModified);
        const heliosArchersDamage = calculateDamage(heliosArchersModified, dominatorsArchersModified);
        const heliosSpearmenDamage = calculateDamage(heliosSpearmenModified, dominatorsSpearmenModified);
        
        const dominatorsInfantryDamage = calculateDamage(dominatorsInfantryModified, heliosInfantryModified);
        const dominatorsArchersDamage = calculateDamage(dominatorsArchersModified, heliosArchersModified);
        const dominatorsSpearmenDamage = calculateDamage(dominatorsSpearmenModified, heliosSpearmenModified);
        
        // Calculate total damage: TotalDamage = Damage ร UnitCount ร (Percentage / 100)
        const heliosTotalInfantryDamage = heliosInfantryDamage * heliosCount * (heliosInfantryPercent / 100);
        const heliosTotalArchersDamage = heliosArchersDamage * heliosCount * (heliosArchersPercent / 100);
        const heliosTotalSpearmenDamage = heliosSpearmenDamage * heliosCount * (heliosSpearmenPercent / 100);
        
        const dominatorsTotalInfantryDamage = dominatorsInfantryDamage * dominatorsCount * (dominatorsInfantryPercent / 100);
        const dominatorsTotalArchersDamage = dominatorsArchersDamage * dominatorsCount * (dominatorsArchersPercent / 100);
        const dominatorsTotalSpearmenDamage = dominatorsSpearmenDamage * dominatorsCount * (dominatorsSpearmenPercent / 100);
        
        // Calculate total damage for each faction
        const heliosTotalDamage = heliosTotalInfantryDamage + heliosTotalArchersDamage + heliosTotalSpearmenDamage;
        const dominatorsTotalDamage = dominatorsTotalInfantryDamage + dominatorsTotalArchersDamage + dominatorsTotalSpearmenDamage;
        
        // Apply attacker bonus (10% more damage)
        let heliosFinalDamage = heliosTotalDamage;
        let dominatorsFinalDamage = dominatorsTotalDamage;
        
        if (attacker === 'helios') {
            heliosFinalDamage *= 1.1;
        } else {
            dominatorsFinalDamage *= 1.1;
        }
        
        // Determine winner
        const isHeliosWinner = heliosFinalDamage > dominatorsFinalDamage;
        const isDraw = heliosFinalDamage === dominatorsFinalDamage;
        
        // Display results
        displayBattleResults(
            isHeliosWinner, 
            isDraw,
            heliosFinalDamage, 
            dominatorsFinalDamage,
            [heliosTotalInfantryDamage, heliosTotalArchersDamage, heliosTotalSpearmenDamage],
            [dominatorsTotalInfantryDamage, dominatorsTotalArchersDamage, dominatorsTotalSpearmenDamage],
            {
                infantry: heliosInfantryLevel,
                archers: heliosArchersLevel,
                spearmen: heliosSpearmenLevel
            },
            {
                infantry: dominatorsInfantryLevel,
                archers: dominatorsArchersLevel,
                spearmen: dominatorsSpearmenLevel
            },
            {
                infantry: heliosInfantryPercent,
                archers: heliosArchersPercent,
                spearmen: heliosSpearmenPercent
            },
            {
                infantry: dominatorsInfantryPercent,
                archers: dominatorsArchersPercent,
                spearmen: dominatorsSpearmenPercent
            },
            attacker
        );
    }
    
    // Get unit stats
    function getUnitStats(faction, unitType, level) {
        const levelIndex = level - 1;
        const statsKey = `${faction}${capitalizeFirstLetter(unitType)}`;
        
        if (unitStats[statsKey]) {
            return {
                attack: unitStats[statsKey].attack[levelIndex],
                defense: unitStats[statsKey].defense[levelIndex],
                health: unitStats[statsKey].health[levelIndex],
                lethality: unitStats[statsKey].lethality[levelIndex]
            };
        }
        
        return { attack: 0, defense: 0, health: 0, lethality: 0 };
    }
    
    // Apply battle skills
    function applyBattleSkills(faction, unitType, stats, level, enemyStats) {
        const modifiedStats = { ...stats };
        
        // Apply common skills
        if (battleSkills[unitType] && battleSkills[unitType].common) {
            battleSkills[unitType].common.forEach(skill => {
                if (skill.name === "ุณูุฏ ุงูุดุฌุนุงู" && unitType === 'infantry') {
                    // +10% damage against spearmen
                    modifiedStats.attack *= 1.1;
                } else if (skill.name === "ุฏุนุงูุงุช ูููุงุฐูุฉ" && unitType === 'infantry') {
                    // +10% defense against spearmen
                    modifiedStats.defense *= 1.1;
                } else if (skill.name === "ุถุฑุจุฉ ุจุนูุฏุฉ ุงููุฏู" && unitType === 'archers') {
                    // +10% damage against infantry
                    modifiedStats.attack *= 1.1;
                } else if (skill.name === "ุงูุงูุฏูุงุน" && unitType === 'spearmen') {
                    // +10% damage against spearmen
                    modifiedStats.attack *= 1.1;
                }
            });
        }
        
        // Apply level-based skills
        if (unitType === 'infantry' && battleSkills[unitType] && battleSkills[unitType].levelBased) {
            for (let skillLevel in battleSkills[unitType].levelBased) {
                if (level >= parseInt(skillLevel)) {
                    const skill = battleSkills[unitType].levelBased[skillLevel];
                    
                    if (skill.name === "ูุฑูุณุชุงู ูุงุฑู") {
                        // Reduce damage by 25%
                        modifiedStats.defense *= 1.25;
                    } else if (skill.name === "ูุฑูุณุชุงู ุฃููู") {
                        // Reduce damage by 35%
                        modifiedStats.defense *= 1.35;
                    } else if (skill.name === "ุฌุณู ุงูุถูุก") {
                        // +4% defense, -10% damage
                        modifiedStats.defense *= 1.04;
                        modifiedStats.attack *= 0.9;
                    } else if (skill.name === "ุฌุณู ุงูุถูุก II") {
                        // +6% defense, -15% damage
                        modifiedStats.defense *= 1.06;
                        modifiedStats.attack *= 0.85;
                    }
                }
            }
        }
        
        return modifiedStats;
    }
    
    // Calculate damage
    function calculateDamage(attackerStats, defenderStats) {
        return Math.max(0, (attackerStats.attack * (1 + attackerStats.lethality / 100)) - (defenderStats.defense * 0.5));
    }
    
    // Display battle results
    function displayBattleResults(isHeliosWinner, isDraw, heliosDamage, dominatorsDamage, heliosUnitDamage, dominatorsUnitDamage, heliosLevels, dominatorsLevels, heliosPercentages, dominatorsPercentages, attacker) {
        const battleResult = document.getElementById('battleResult');
        const battleWinner = document.getElementById('battleWinner');
        const battleDetails = document.getElementById('battleDetails');
        const battleAnalysis = document.getElementById('battleAnalysis');
        const resultGif = document.getElementById('resultGif');
        
        // Show battle result section
        battleResult.style.display = 'block';
        
        // Display winner
        if (isDraw) {
            battleWinner.textContent = "ุชุนุงุฏู!";
            battleWinner.className = "battle-winner draw";
        } else if (isHeliosWinner) {
            battleWinner.textContent = "ูููููุณ ุงูุชุตุฑ!";
            battleWinner.className = "battle-winner helios";
            resultGif.src = "https://i.imgur.com/yLFc99G.gif";
        } else {
            battleWinner.textContent = "ุงูููููููู ุงูุชุตุฑูุง!";
            battleWinner.className = "battle-winner dominant";
            resultGif.src = "https://i.imgur.com/rbmHcNu.gif";
        }
        
        // Show result GIF
        if (!isDraw) {
            resultGif.style.display = 'block';
        }
        
        // Display battle details
        const damageDifference = Math.abs(heliosDamage - dominatorsDamage);
        const damagePercentage = Math.round((damageDifference / Math.min(heliosDamage, dominatorsDamage)) * 100);
        
        let detailsHTML = '';
        detailsHTML += `<h4>ุชูุงุตูู ุงููุนุฑูุฉ:</h4>`;
        detailsHTML += `<p>ุงูููุงุฌู: ${attacker === 'helios' ? 'ูููููุณ' : 'ุงูููููููู'}</p>`;
        detailsHTML += `<p>ุฅุฌูุงูู ุถุฑุฑ ูููููุณ: <strong>${Math.round(heliosDamage).toLocaleString()}</strong></p>`;
        detailsHTML += `<p>ุฅุฌูุงูู ุถุฑุฑ ุงูููููููู: <strong>${Math.round(dominatorsDamage).toLocaleString()}</strong></p>`;
        
        if (!isDraw) {
            detailsHTML += `<p>ูุงุฑู ุงูุถุฑุฑ: <strong>${Math.round(damageDifference).toLocaleString()} (${damagePercentage}%)</strong></p>`;
        }
        
        battleDetails.innerHTML = detailsHTML;
        
        // Display battle analysis
        let analysisHTML = '';
        analysisHTML += `<h4>ุชุญููู ุงููุนุฑูุฉ:</h4>`;
        
        if (isHeliosWinner) {
            analysisHTML += `<p>ุชูููุช ููุงุช ูููููุณ ุจูุถู `;
            
            if (heliosLevels.infantry >= 5) {
                analysisHTML += `ูุณุชูู ุงููุดุงุฉ ุงูุนุงูู (${heliosLevels.infantry}) ูุชุฃุซูุฑ ููุงุฑุฉ "ูุฑูุณุชุงู ุฃููู"ุ `;
            }
            
            if (heliosPercentages.archers > 30) {
                analysisHTML += `ููุณุจุฉ ุงูุฑูุงุฉ ุงูุนุงููุฉ (${heliosPercentages.archers}%) ูุงูุชู ุฃุซุฑุช ุนูู ุงูุถุฑุฑ ุงูุฅุฌูุงููุ `;
            }
            
            if (attacker === 'helios') {
                analysisHTML += `ูููุฒุฉ ุงูููุงุฌู (+10% ุถุฑุฑ). `;
            }
            
            analysisHTML += `</p>`;
            
            // Suggest improvements for dominators
            analysisHTML += `<p>ููููููููู: ูููู ุชุญุณูู ุงูุชุดูููุฉ ูู ุฎูุงู `;
            
            if (dominatorsLevels.infantry < 5) {
                analysisHTML += `ุฑูุน ูุณุชูู ุงููุดุงุฉ ููุงุณุชูุงุฏุฉ ูู ููุงุฑุฉ "ูุฑูุณุชุงู ุฃููู"ุ `;
            }
            
            if (dominatorsPercentages.archers < 30) {
                analysisHTML += `ุฒูุงุฏุฉ ูุณุจุฉ ุงูุฑูุงุฉ ูุฒูุงุฏุฉ ุงูุถุฑุฑ ุงูุฅุฌูุงููุ `;
            }
            
            analysisHTML += `</p>`;
        } else if (!isDraw) {
            analysisHTML += `<p>ุชูููุช ููุงุช ุงูููููููู ุจูุถู `;
            
            if (dominatorsLevels.infantry >= 5) {
                analysisHTML += `ูุณุชูู ุงููุดุงุฉ ุงูุนุงูู (${dominatorsLevels.infantry}) ูุชุฃุซูุฑ ููุงุฑุฉ "ูุฑูุณุชุงู ุฃููู"ุ `;
            }
            
            if (dominatorsPercentages.archers > 30) {
                analysisHTML += `ููุณุจุฉ ุงูุฑูุงุฉ ุงูุนุงููุฉ (${dominatorsPercentages.archers}%) ูุงูุชู ุฃุซุฑุช ุนูู ุงูุถุฑุฑ ุงูุฅุฌูุงููุ `;
            }
            
            if (attacker === 'dominators') {
                analysisHTML += `ูููุฒุฉ ุงูููุงุฌู (+10% ุถุฑุฑ). `;
            }
            
            analysisHTML += `</p>`;
            
            // Suggest improvements for helios
            analysisHTML += `<p>ููููููุณ: ูููู ุชุญุณูู ุงูุชุดูููุฉ ูู ุฎูุงู `;
            
            if (heliosLevels.infantry < 5) {
                analysisHTML += `ุฑูุน ูุณุชูู ุงููุดุงุฉ ููุงุณุชูุงุฏุฉ ูู ููุงุฑุฉ "ูุฑูุณุชุงู ุฃููู"ุ `;
            }
            
            if (heliosPercentages.archers < 30) {
                analysisHTML += `ุฒูุงุฏุฉ ูุณุจุฉ ุงูุฑูุงุฉ ูุฒูุงุฏุฉ ุงูุถุฑุฑ ุงูุฅุฌูุงููุ `;
            }
            
            analysisHTML += `</p>`;
        } else {
            analysisHTML += `<p>ุชุนุงุฏูุช ุงูููุชุงู ุจุดูู ูุซูุฑ ููุฏูุดุฉ! ุญุงูู ุชุนุฏูู ุงูุชุดูููุฉ ุฃู ุงููุณุชููุงุช ููุญุตูู ุนูู ูุชูุฌุฉ ุญุงุณูุฉ.</p>`;
        }
        
        battleAnalysis.innerHTML = analysisHTML;
        
        // Draw battle chart
        drawBattleChart(heliosUnitDamage, dominatorsUnitDamage);
    }
    
    // Draw battle chart
    function drawBattleChart(heliosData, dominatorsData) {
        const ctx = document.getElementById('battleChart');
        if (!ctx) return;
        
        // Destroy existing chart if it exists
        if (chartObjects.battleChart) {
            try {
                chartObjects.battleChart.destroy();
            } catch (e) {
                console.log('Error destroying battle chart:', e);
            }
        }
        
        // Format data for better display
        const formattedHeliosData = heliosData.map(value => Math.round(value));
        const formattedDominatorsData = dominatorsData.map(value => Math.round(value));
        
        // Create new chart
        chartObjects.battleChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['ูุดุงุฉ', 'ุฑูุงุฉ', 'ุฑูุญ'],
                datasets: [
                    {
                        label: 'ูููููุณ',
                        data: formattedHeliosData,
                        backgroundColor: 'rgba(244, 67, 54, 0.5)',
                        borderColor: 'rgba(244, 67, 54, 1)',
                        borderWidth: 1
                    },
                    {
                        label: 'ุงูููููููู',
                        data: formattedDominatorsData,
                        backgroundColor: 'rgba(255, 193, 7, 0.5)',
                        borderColor: 'rgba(255, 193, 7, 1)',
                        borderWidth: 1
                    }
                ]
            },
            options: {
                responsive: true,
                scales: {
                    y: {
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: 'ุงูุถุฑุฑ ุงูุฅุฌูุงูู'
                        }
                    }
                },
                plugins: {
                    title: {
                        display: true,
                        text: 'ููุงุฑูุฉ ุงูุถุฑุฑ ุจูู ุงููุตุงุฆู'
                    }
                }
            }
        });
    }
    
    // Challenge system variables
    let currentPlayer = null;
    let currentChallenge = null;
    let challenges = JSON.parse(localStorage.getItem('challengesList') || '[]');
    let weeklyChampion = JSON.parse(localStorage.getItem('weeklyChampion') || 'null');
    let battleResults = JSON.parse(localStorage.getItem('battleResults') || '[]');

    // Challenge system functions
    function savePlayerInfo() {
        const playerName = document.getElementById('playerName').value.trim();
        const serverNumber = document.getElementById('serverNumber').value;
        
        if (!playerName || playerName.length > 5) {
            alert('ูุฑุฌู ุฅุฏุฎุงู ุงุณู ุตุญูุญ (5 ุฃุญุฑู ูุญุฏ ุฃูุตู)');
            return;
        }
        
        if (!serverNumber || serverNumber.length !== 4) {
            alert('ูุฑุฌู ุฅุฏุฎุงู ุฑูู ุณูุฑูุฑ ุตุญูุญ (4 ุฃุฑูุงู)');
            return;
        }
        
        currentPlayer = {
            name: playerName,
            server: serverNumber
        };
        
        localStorage.setItem('currentPlayer', JSON.stringify(currentPlayer));
        
        document.getElementById('challengeCreationSection').style.display = 'block';
        alert('ุชู ุญูุธ ูุนูููุงุชู ุจูุฌุงุญ! ููููู ุงูุขู ุฅูุดุงุก ุชุญุฏู.');
    }

    function updateChallengeSkills() {
        const levelSelect = document.getElementById('challengeLevel');
        const selectedValue = parseInt(levelSelect.value);
        
        let level, faction;
        if (selectedValue <= 10) {
            level = selectedValue;
            faction = 'ูููููุณ';
        } else {
            level = selectedValue - 10;
            faction = 'ุงูููููููู';
        }
        
        const skills = getCombatSkills(level);
        const skillsHTML = `
            <h4>ููุงุฑุงุช ุงููุณุชูู ${level} - ${faction}:</h4>
            <div class="skill-list">
                ${skills.map(skill => `<span class="skill-item" title="${skill.description}">${skill.name}</span>`).join('')}
            </div>
        `;
        document.getElementById('challengeSkills').innerHTML = skillsHTML;
    }
    
    function getCombatSkills(level) {
        const allSkills = [];
        
        // ููุงุฑุงุช ุงููุดุงุฉ ุงูุชููุงุฆูุฉ
        allSkills.push(
            { name: 'ุณูุฏ ุงูุดุฌุนุงู', description: '+10% ุถุฑุฑ ุถุฏ ุฑูุงุฉ ุงูุฑูุญ' },
            { name: 'ุฏุนุงูุงุช ูููุงุฐูุฉ', description: '+10% ุฏูุงุน ุถุฏ ุฑูุงุฉ ุงูุฑูุญ' }
        );
        
        // ููุงุฑุงุช ุงููุดุงุฉ ุญุณุจ ุงููุณุชูู
        if (level >= 3) {
            allSkills.push({ name: 'ูุฑูุณุชุงู ูุงุฑู', description: 'ุชูููู 25% ูู ุงูุถุฑุฑ' });
        }
        if (level >= 5) {
            allSkills.push({ name: 'ูุฑูุณุชุงู ุฃููู', description: 'ุชูููู 35% ูู ุงูุถุฑุฑ' });
        }
        if (level >= 8) {
            allSkills.push({ name: 'ุฌุณู ุงูุถูุก', description: '+4% ุฏูุงุนุ -10% ุถุฑุฑ' });
        }
        if (level >= 10) {
            allSkills.push({ name: 'ุฌุณู ุงูุถูุก II', description: '+6% ุฏูุงุนุ -15% ุถุฑุฑ' });
        }
        
        // ููุงุฑุงุช ุฑูุงุฉ ุงูุฑูุญ
        allSkills.push(
            { name: 'ุงูุงูุฏูุงุน', description: '+10% ุถุฏ ุฑูุงุฉ ุงูุฑูุญ' },
            { name: 'ุงููุชุฑุจุต', description: 'ูุฑุตุฉ 20% ูุชุฌุงูุฒ ุงูุตู ุงูุฃูุงูู' }
        );
        
        // ููุงุฑุงุช ุงูุฑูุงุฉ
        allSkills.push(
            { name: 'ุถุฑุจุฉ ุจุนูุฏุฉ ุงููุฏู', description: '+10% ุถุฑุฑ ุถุฏ ุงููุดุงุฉ' }
        );
        
        return allSkills;
    }

    function updateChallengeComposition() {
        const infantrySlider = document.getElementById('challengeInfantrySlider');
        const archerSlider = document.getElementById('challengeArcherSlider');
        const lancerSlider = document.getElementById('challengeLancerSlider');
        
        let infantry = parseInt(infantrySlider.value);
        let archer = parseInt(archerSlider.value);
        let lancer = parseInt(lancerSlider.value);
        
        const total = infantry + archer + lancer;
        if (total !== 100) {
            const diff = 100 - total;
            const currentSlider = event.target;
            
            if (currentSlider === infantrySlider) {
                const remaining = diff;
                const archerAdjust = Math.floor(remaining / 2);
                const lancerAdjust = remaining - archerAdjust;
                
                archer = Math.max(0, Math.min(100, archer + archerAdjust));
                lancer = Math.max(0, Math.min(100, lancer + lancerAdjust));
                
                archerSlider.value = archer;
                lancerSlider.value = lancer;
            } else if (currentSlider === archerSlider) {
                const remaining = diff;
                const infantryAdjust = Math.floor(remaining / 2);
                const lancerAdjust = remaining - infantryAdjust;
                
                infantry = Math.max(0, Math.min(100, infantry + infantryAdjust));
                lancer = Math.max(0, Math.min(100, lancer + lancerAdjust));
                
                infantrySlider.value = infantry;
                lancerSlider.value = lancer;
            } else if (currentSlider === lancerSlider) {
                const remaining = diff;
                const infantryAdjust = Math.floor(remaining / 2);
                const archerAdjust = remaining - infantryAdjust;
                
                infantry = Math.max(0, Math.min(100, infantry + infantryAdjust));
                archer = Math.max(0, Math.min(100, archer + archerAdjust));
                
                infantrySlider.value = infantry;
                archerSlider.value = archer;
            }
        }
        
        document.getElementById('challengeInfantryValue').textContent = infantry + '%';
        document.getElementById('challengeArcherValue').textContent = archer + '%';
        document.getElementById('challengeLancerValue').textContent = lancer + '%';
        document.getElementById('challengeCompositionTotal').textContent = (infantry + archer + lancer) + '%';
        
        const totalTroops = 100000;
        document.getElementById('challengeInfantryCount').textContent = Math.floor(infantry * totalTroops / 100).toLocaleString();
        document.getElementById('challengeArcherCount').textContent = Math.floor(archer * totalTroops / 100).toLocaleString();
        document.getElementById('challengeLancerCount').textContent = Math.floor(lancer * totalTroops / 100).toLocaleString();
    }

    function createChallenge() {
        if (!currentPlayer) {
            alert('ูุฑุฌู ุญูุธ ูุนูููุงุชู ุฃููุงู');
            return;
        }
        
        const levelSelect = document.getElementById('challengeLevel');
        const selectedValue = parseInt(levelSelect.value);
        const role = document.getElementById('challengeRole').value;
        
        let level, faction;
        if (selectedValue <= 10) {
            level = selectedValue;
            faction = 'helios';
        } else {
            level = selectedValue - 10;
            faction = 'dominant';
        }
        
        const composition = {
            infantry: parseInt(document.getElementById('challengeInfantrySlider').value),
            archer: parseInt(document.getElementById('challengeArcherSlider').value),
            lancer: parseInt(document.getElementById('challengeLancerSlider').value)
        };
        
        const challenge = {
            id: Date.now(),
            challenger: currentPlayer,
            level: level,
            faction: faction,
            role: role,
            composition: composition,
            timestamp: new Date().toISOString()
        };
        
        currentChallenge = challenge;
        challenges.push(challenge);
        localStorage.setItem('challengesList', JSON.stringify(challenges));
        
        document.getElementById('challengeWaiting').style.display = 'block';
        document.getElementById('createChallengeBtn').disabled = true;
        
        loadChallenges();
    }

    function cancelChallenge() {
        if (currentChallenge) {
            challenges = challenges.filter(c => c.id !== currentChallenge.id);
            localStorage.setItem('challengesList', JSON.stringify(challenges));
            currentChallenge = null;
        }
        
        document.getElementById('challengeWaiting').style.display = 'none';
        document.getElementById('createChallengeBtn').disabled = false;
        
        loadChallenges();
    }

    function acceptChallenge(challengeId) {
        const challenge = challenges.find(c => c.id === challengeId);
        if (!challenge) {
            alert('ุงูุชุญุฏู ุบูุฑ ููุฌูุฏ');
            return;
        }
        
        // ุนุฑุถ ูููุฐุฌ ุชุณุฌูู ุงููุงุนุจ ุงูุซุงูู
        showPlayer2RegistrationForm(challenge);
    }
    
    function showPlayer2RegistrationForm(challenge) {
        const modalHTML = `
            <div id="player2RegistrationModal" class="modal-overlay">
                <div class="modal-content" style="max-width: 400px;">
                    <h3 class="modal-title">ุชุณุฌูู ูุนูููุงุช ุงููุชุญุฏู ุงูุซุงูู</h3>
                    <div style="margin: 20px 0;">
                        <div class="form-group">
                            <label for="player2Name">ุงุณู ุงููุชุญุฏู ุงูุซุงูู (5 ุฃุญุฑู ูุญุฏ ุฃูุตู):</label>
                            <input type="text" id="player2Name" maxlength="5" placeholder="ุงุณูู" style="width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ddd; border-radius: 4px;">
                        </div>
                        <div class="form-group">
                            <label for="player2Server">ุฑูู ุงูุณูุฑูุฑ (4 ุฃุฑูุงู):</label>
                            <input type="number" id="player2Server" min="1" max="9999" placeholder="1234" style="width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ddd; border-radius: 4px;">
                        </div>
                    </div>
                    <div class="modal-buttons" style="flex-direction: column; gap: 10px;">
                        <button onclick="confirmPlayer2Registration(${challenge.id})" style="background-color: #28a745; color: white; border: none; padding: 15px 30px; border-radius: 8px; font-size: 16px; font-weight: bold; cursor: pointer; width: 100%;">
                            ุชุฃููุฏ ููุจูู ุงูุชุญุฏู
                        </button>
                        <button onclick="closePlayer2RegistrationModal()" style="background-color: #6c757d; color: white; border: none; padding: 10px 20px; border-radius: 8px; font-size: 14px; cursor: pointer; width: 100%;">
                            ุฅูุบุงุก
                        </button>
                    </div>
                </div>
            </div>
        `;
        
        document.body.insertAdjacentHTML('beforeend', modalHTML);
    }
    
    function confirmPlayer2Registration(challengeId) {
        const player2Name = document.getElementById('player2Name').value.trim();
        const player2Server = document.getElementById('player2Server').value;
        
        if (!player2Name || player2Name.length > 5) {
            alert('ูุฑุฌู ุฅุฏุฎุงู ุงุณู ุตุญูุญ (5 ุฃุญุฑู ูุญุฏ ุฃูุตู)');
            return;
        }
        
        if (!player2Server || player2Server.length !== 4) {
            alert('ูุฑุฌู ุฅุฏุฎุงู ุฑูู ุณูุฑูุฑ ุตุญูุญ (4 ุฃุฑูุงู)');
            return;
        }
        
        // ุชุญุฏูุซ ูุนูููุงุช ุงููุงุนุจ ุงูุซุงูู
        currentPlayer = {
            name: player2Name,
            server: player2Server
        };
        
        localStorage.setItem('currentPlayer', JSON.stringify(currentPlayer));
        
        // ุฅุบูุงู ุงููููุฐุฌ
        closePlayer2RegistrationModal();
        
        // ูุชุงุจุนุฉ ุฅุนุฏุงุฏ ุงููุนุฑูุฉ
        const challenge = challenges.find(c => c.id === challengeId);
        currentChallenge = challenge;
        setupBattlePreparation(challenge);
        
        challenges = challenges.filter(c => c.id !== challengeId);
        localStorage.setItem('challengesList', JSON.stringify(challenges));
        loadChallenges();
    }
    
    function closePlayer2RegistrationModal() {
        const modal = document.getElementById('player2RegistrationModal');
        if (modal) {
            modal.remove();
        }
    }

    function setupBattlePreparation(challenge) {
        document.getElementById('battlePreparation').style.display = 'block';
        
        // ุงูุชุฃูุฏ ูู ูุฌูุฏ ูุนูููุงุช ุงููุงุนุจูู
        const challenger1Name = `${challenge.challenger.name} (${challenge.challenger.server})`;
        const challenger2Name = currentPlayer ? `${currentPlayer.name} (${currentPlayer.server})` : 'ุบูุฑ ูุญุฏุฏ';
        
        document.getElementById('challenger1Name').textContent = challenger1Name;
        document.getElementById('challenger2Name').textContent = challenger2Name;
        
        const factionName = challenge.faction === 'helios' ? 'ูููููุณ' : 'ุงูููููููู';
        const roleName = challenge.role === 'attacker' ? 'ููุงุฌู' : 'ูุฏุงูุน';
        const challenger2Role = challenge.role === 'attacker' ? 'ูุฏุงูุน' : 'ููุงุฌู';
        
        document.getElementById('challenger1Details').innerHTML = `
            <h5>ุงููุณุชูู: ${challenge.level} - ${factionName}</h5>
            <p>ุงูุฏูุฑ: ${roleName}</p>
            <h6>ุชุดูููุฉ ุงูุฌูุด:</h6>
            <p>ุงููุดุงุฉ: ${challenge.composition.infantry}% (${Math.floor(challenge.composition.infantry * 1000).toLocaleString()})</p>
            <p>ุงูุฑูุงุฉ: ${challenge.composition.archer}% (${Math.floor(challenge.composition.archer * 1000).toLocaleString()})</p>
            <p>ุงูุฑูุญ: ${challenge.composition.lancer}% (${Math.floor(challenge.composition.lancer * 1000).toLocaleString()})</p>
            
            <div class="level-skills">
                <h6>ุงูููุงุฑุงุช ุงููุชุงุญุฉ:</h6>
                <div class="skill-list">
                    ${getCombatSkills(challenge.level).map(skill => `<span class="skill-item" title="${skill.description}">${skill.name}</span>`).join('')}
                </div>
            </div>
        `;
        
        // ุชุญุฏูุซ ูุนูููุงุช ุงููุชุญุฏู ุงูุซุงูู ุจููุณ ุงููุณุชูู ูุงููุตูู
        document.getElementById('challenger2Config').innerHTML = `
            <h4>ุงููุชุญุฏู ุงูุซุงูู</h4>
            <div style="background-color: #e3f2fd; padding: 15px; border-radius: 5px; margin-bottom: 15px;">
                <h5>ุงููุณุชูู: ${challenge.level} - ${factionName} (${challenger2Role})</h5>
                <p><strong>ููุงุญุธุฉ:</strong> ุณุชุญุงุฑุจ ุจููุณ ูุณุชูู ููุตูู ุฎุตูู ุชููุงุฆูุงู</p>
                
                <div class="level-skills">
                    <h6>ุงูููุงุฑุงุช ุงููุชุงุญุฉ:</h6>
                    <div class="skill-list">
                        ${getCombatSkills(challenge.level).map(skill => `<span class="skill-item" title="${skill.description}">${skill.name}</span>`).join('')}
                    </div>
                </div>
            </div>
            
            <h5>ุงุฎุชุฑ ุชุดูููุฉ ุฌูุดู:</h5>
            <div class="army-composition">
                <div class="composition-row">
                    <div class="composition-label">ุงููุดุงุฉ:</div>
                    <input type="range" class="composition-slider" id="defender2InfantrySlider" min="0" max="100" value="50" oninput="updateDefender2Composition()">
                    <div class="composition-value" id="defender2InfantryValue">50%</div>
                </div>
                <div class="composition-row">
                    <div class="composition-label">ุงูุฑูุงุฉ:</div>
                    <input type="range" class="composition-slider" id="defender2ArcherSlider" min="0" max="100" value="30" oninput="updateDefender2Composition()">
                    <div class="composition-value" id="defender2ArcherValue">30%</div>
                </div>
                <div class="composition-row">
                    <div class="composition-label">ุงูุฑูุญ:</div>
                    <input type="range" class="composition-slider" id="defender2LancerSlider" min="0" max="100" value="20" oninput="updateDefender2Composition()">
                    <div class="composition-value" id="defender2LancerValue">20%</div>
                </div>
                <div class="composition-row">
                    <strong>ุงููุฌููุน: <span id="defender2CompositionTotal">100%</span></strong>
                </div>
                <div class="composition-row">
                    <div style="font-size: 14px; color: #666; margin-top: 10px;">
                        ุฃุนุฏุงุฏ ุงูููุงุช (ูู ุฅุฌูุงูู 100,000):
                        <div>ุงููุดุงุฉ: <span id="defender2InfantryCount">50,000</span></div>
                        <div>ุงูุฑูุงุฉ: <span id="defender2ArcherCount">30,000</span></div>
                        <div>ุงูุฑูุญ: <span id="defender2LancerCount">20,000</span></div>
                    </div>
                </div>
            </div>
        `;
        
        updateDefender2Composition();
    }

    function updateDefender2Composition() {
        const infantrySlider = document.getElementById('defender2InfantrySlider');
        const archerSlider = document.getElementById('defender2ArcherSlider');
        const lancerSlider = document.getElementById('defender2LancerSlider');
        
        if (!infantrySlider) return;
        
        let infantry = parseInt(infantrySlider.value);
        let archer = parseInt(archerSlider.value);
        let lancer = parseInt(lancerSlider.value);
        
        const total = infantry + archer + lancer;
        if (total !== 100) {
            const diff = 100 - total;
            const currentSlider = event.target;
            
            if (currentSlider === infantrySlider) {
                const remaining = diff;
                const archerAdjust = Math.floor(remaining / 2);
                const lancerAdjust = remaining - archerAdjust;
                
                archer = Math.max(0, Math.min(100, archer + archerAdjust));
                lancer = Math.max(0, Math.min(100, lancer + lancerAdjust));
                
                archerSlider.value = archer;
                lancerSlider.value = lancer;
            } else if (currentSlider === archerSlider) {
                const remaining = diff;
                const infantryAdjust = Math.floor(remaining / 2);
                const lancerAdjust = remaining - infantryAdjust;
                
                infantry = Math.max(0, Math.min(100, infantry + infantryAdjust));
                lancer = Math.max(0, Math.min(100, lancer + lancerAdjust));
                
                infantrySlider.value = infantry;
                lancerSlider.value = lancer;
            } else if (currentSlider === lancerSlider) {
                const remaining = diff;
                const infantryAdjust = Math.floor(remaining / 2);
                const archerAdjust = remaining - infantryAdjust;
                
                infantry = Math.max(0, Math.min(100, infantry + infantryAdjust));
                archer = Math.max(0, Math.min(100, archer + archerAdjust));
                
                infantrySlider.value = infantry;
                archerSlider.value = archer;
            }
        }
        
        document.getElementById('defender2InfantryValue').textContent = infantry + '%';
        document.getElementById('defender2ArcherValue').textContent = archer + '%';
        document.getElementById('defender2LancerValue').textContent = lancer + '%';
        document.getElementById('defender2CompositionTotal').textContent = (infantry + archer + lancer) + '%';
        
        // ุชุญุฏูุซ ุฃุนุฏุงุฏ ุงูููุงุช
        const totalTroops = 100000;
        document.getElementById('defender2InfantryCount').textContent = Math.floor(infantry * totalTroops / 100).toLocaleString();
        document.getElementById('defender2ArcherCount').textContent = Math.floor(archer * totalTroops / 100).toLocaleString();
        document.getElementById('defender2LancerCount').textContent = Math.floor(lancer * totalTroops / 100).toLocaleString();
    }

    function startChallengeBattle() {
        if (!currentChallenge) {
            alert('ูุง ููุฌุฏ ุชุญุฏู ูุดุท');
            return;
        }
        
        const challenger2Composition = {
            infantry: parseInt(document.getElementById('defender2InfantrySlider').value),
            archer: parseInt(document.getElementById('defender2ArcherSlider').value),
            lancer: parseInt(document.getElementById('defender2LancerSlider').value)
        };
        
        if (challenger2Composition.infantry + challenger2Composition.archer + challenger2Composition.lancer !== 100) {
            alert('ูุฌุจ ุฃู ูููู ูุฌููุน ุงููุณุจ 100%');
            return;
        }
        
        showBattleCountdown(() => {
            const battleResult = simulateChallengeBattle(currentChallenge, challenger2Composition);
            displayChallengeBattleResults(battleResult);
        });
    }

    function simulateChallengeBattle(challenge, challenger2Comp) {
        const level = challenge.level;
        const totalTroops = 100000;
        
        // ููุง ุงููุชุญุฏููู ูุณุชุฎุฏูุงู ููุณ ุงููุตูู ูุงููุณุชูู
        const challengerFaction = challenge.faction;
        
        // ุญุณุงุจ ุฃุนุฏุงุฏ ุงูููุงุช ูููุชุญุฏู ุงูุฃูู
        const challenger1Army = {
            infantry: Math.floor((challenge.composition.infantry / 100) * totalTroops),
            archers: Math.floor((challenge.composition.archer / 100) * totalTroops),
            spearmen: Math.floor((challenge.composition.lancer / 100) * totalTroops)
        };
        
        // ุญุณุงุจ ุฃุนุฏุงุฏ ุงูููุงุช ูููุชุญุฏู ุงูุซุงูู (ุจููุณ ุงููุตูู ูุงููุณุชูู)
        const challenger2Army = {
            infantry: Math.floor((challenger2Comp.infantry / 100) * totalTroops),
            archers: Math.floor((challenger2Comp.archer / 100) * totalTroops),
            spearmen: Math.floor((challenger2Comp.lancer / 100) * totalTroops)
        };
        
        // ุญุณุงุจ ุงูุถุฑุฑ ุงูุฅุฌูุงูู ูุน ุงูููุงุฑุงุช
        const challenger1Damage = calculateAdvancedBattleDamage(challengerFaction, level, challenger1Army, challenge.role);
        const challenger2Damage = calculateAdvancedBattleDamage(challengerFaction, level, challenger2Army, challenge.role === 'attacker' ? 'defender' : 'attacker');
        
        // ุญุณุงุจ ูุชูุฌุฉ ุงููุนุฑูุฉ
        const battleAnalysis = analyzeBattleOutcome(challenger1Damage, challenger2Damage, challenger1Army, challenger2Army);
        
        // ุชุญุฏูุฏ ุงููุงุฆุฒ
        let challengeWinner;
        if (battleAnalysis.winner === 'draw') {
            challengeWinner = 'draw';
        } else if (battleAnalysis.winner === 'challenger1') {
            challengeWinner = challenge.challenger;
        } else {
            challengeWinner = currentPlayer;
        }
        
        const battleResult = {
            challenger1: challenge.challenger,
            challenger2: currentPlayer,
            winner: challengeWinner,
            level: challenge.level,
            faction: challengerFaction,
            timestamp: new Date().toISOString()
        };
        
        battleResults.push(battleResult);
        localStorage.setItem('battleResults', JSON.stringify(battleResults));
        
        updateWeeklyChampion(challengeWinner);
        
        return {
            winner: battleAnalysis.winner,
            challengeWinner,
            challenger1Damage,
            challenger2Damage,
            challenger1Army,
            challenger2Army,
            battleResult,
            analysis: battleAnalysis,
            faction: challengerFaction,
            level: challenge.level
        };
    }
    
    function calculateAdvancedBattleDamage(faction, level, army, role) {
        let totalDamage = 0;
        let survivalScore = 0;
        let tacticalAdvantage = 0;
        
        // ุญุณุงุจ ุถุฑุฑ ุงููุดุงุฉ ูุน ุฌููุน ุงูููุงุฑุงุช
        if (army.infantry > 0) {
            const infantryStats = faction === 'helios' ? unitStats.heliosInfantry : unitStats.dominatorsInfantry;
            let attack = infantryStats.attack[level - 1];
            let defense = infantryStats.defense[level - 1];
            let health = infantryStats.health[level - 1];
            let lethality = infantryStats.lethality[level - 1];
            
            // ุชุทุจูู ููุงุฑุงุช ุงููุดุงุฉ ุญุณุจ ุงููุณุชูู
            const infantryModifiers = getInfantrySkillEffects(level);
            attack *= infantryModifiers.attackModifier;
            defense *= infantryModifiers.defenseModifier;
            
            // ููุงุฑุงุช ุงููุดุงุฉ ุงูุชููุงุฆูุฉ
            defense *= 1.1; // ุฏุนุงูุงุช ูููุงุฐูุฉ: +10% ุฏูุงุน ุถุฏ ุฑูุงุฉ ุงูุฑูุญ
            
            // ุฏูุฑ ุงูููุงุฌู ูุงููุฏุงูุน
            if (role === 'attacker') {
                attack *= 1.05; // ููุงูุฃุฉ ุงูููุงุฌู
            } else {
                defense *= 1.1; // ููุงูุฃุฉ ุงููุฏุงูุน
            }
            
            const effectiveDamage = ((attack * (1 + lethality / 100)) - (defense * 0.5)) * infantryModifiers.damageReduction;
            const unitDamage = Math.max(effectiveDamage, attack * 0.1); // ุถูุงู ุถุฑุฑ ุฃุฏูู
            
            totalDamage += unitDamage * army.infantry;
            survivalScore += (health * defense * army.infantry) / 1000;
        }
        
        // ุญุณุงุจ ุถุฑุฑ ุงูุฑูุงุฉ ูุน ุงูููุงุฑุงุช
        if (army.archers > 0) {
            const archersStats = faction === 'helios' ? unitStats.heliosArchers : unitStats.dominatorsArchers;
            let attack = archersStats.attack[level - 1];
            let defense = archersStats.defense[level - 1];
            let health = archersStats.health[level - 1];
            let lethality = archersStats.lethality[level - 1];
            
            // ููุงุฑุฉ "ุถุฑุจุฉ ุจุนูุฏุฉ ุงููุฏู": +10% ุถุฑุฑ ุถุฏ ุงููุดุงุฉ
            attack *= 1.1;
            
            // ุฏูุฑ ุงูููุงุฌู ูุงููุฏุงูุน
            if (role === 'attacker') {
                attack *= 1.08; // ุงูุฑูุงุฉ ุฃููู ูู ุงููุฌูู
            } else {
                defense *= 1.05;
            }
            
            const effectiveDamage = (attack * (1 + lethality / 100)) - (defense * 0.3);
            const unitDamage = Math.max(effectiveDamage, attack * 0.15);
            
            totalDamage += unitDamage * army.archers;
            survivalScore += (health * defense * army.archers) / 1200;
            tacticalAdvantage += army.archers * 0.5; // ุงูุฑูุงุฉ ูููุฑูู ููุฒุฉ ุชูุชูููุฉ
        }
        
        // ุญุณุงุจ ุถุฑุฑ ุฑูุงุฉ ุงูุฑูุญ ูุน ุงูููุงุฑุงุช
        if (army.spearmen > 0) {
            const spearmenStats = faction === 'helios' ? unitStats.heliosSpearmen : unitStats.dominatorsSpearmen;
            let attack = spearmenStats.attack[level - 1];
            let defense = spearmenStats.defense[level - 1];
            let health = spearmenStats.health[level - 1];
            let lethality = spearmenStats.lethality[level - 1];
            
            // ููุงุฑุงุช ุฑูุงุฉ ุงูุฑูุญ
            attack *= 1.1; // ุงูุงูุฏูุงุน: +10%
            attack *= 1.2; // ุงููุชุฑุจุต: ูุฑุตุฉ 20% ูุชุฌุงูุฒ ุงูุตู ุงูุฃูุงูู
            
            // ุฏูุฑ ุงูููุงุฌู ูุงููุฏุงูุน
            if (role === 'attacker') {
                attack *= 1.12; // ุฑูุงุฉ ุงูุฑูุญ ููุชุงุฒูู ูู ุงููุฌูู
            } else {
                defense *= 1.08;
            }
            
            const effectiveDamage = (attack * (1 + lethality / 100)) - (defense * 0.4);
            const unitDamage = Math.max(effectiveDamage, attack * 0.2);
            
            totalDamage += unitDamage * army.spearmen;
            survivalScore += (health * defense * army.spearmen) / 1100;
            tacticalAdvantage += army.spearmen * 0.3;
        }
        
        // ุญุณุงุจ ุงูููุงุท ุงูุฅุฌูุงููุฉ ูููุนุฑูุฉ
        const battleScore = totalDamage + (survivalScore * 2) + (tacticalAdvantage * 10);
        
        return {
            totalDamage: Math.max(0, totalDamage),
            survivalScore,
            tacticalAdvantage,
            battleScore,
            armyComposition: army
        };
    }
    
    function getInfantrySkillEffects(level) {
        let damageReduction = 1.0;
        let defenseModifier = 1.0;
        let attackModifier = 1.0;
        
        // ููุงุฑุงุช ุงููุณุชูู ูููุดุงุฉ
        if (level >= 3) {
            damageReduction = 0.75; // ูุฑูุณุชุงู ูุงุฑู: ุชูููู 25% ูู ุงูุถุฑุฑ ุงููุงุฑุฏ
        }
        if (level >= 5) {
            damageReduction = 0.65; // ูุฑูุณุชุงู ุฃููู: ุชูููู 35% ูู ุงูุถุฑุฑ ุงููุงุฑุฏ
        }
        if (level >= 8) {
            defenseModifier *= 1.04; // ุฌุณู ุงูุถูุก: +4% ุฏูุงุน
            attackModifier *= 0.90; // ุฌุณู ุงูุถูุก: -10% ุถุฑุฑ
        }
        if (level >= 10) {
            defenseModifier *= 1.06; // ุฌุณู ุงูุถูุก II: +6% ุฏูุงุน (ุฅุถุงูู)
            attackModifier *= 0.85; // ุฌุณู ุงูุถูุก II: -15% ุถุฑุฑ (ุฅุถุงูู)
        }
        
        return {
            damageReduction,
            defenseModifier,
            attackModifier
        };
    }
    
    function analyzeBattleOutcome(challenger1Result, challenger2Result, army1, army2) {
        const score1 = challenger1Result.battleScore;
        const score2 = challenger2Result.battleScore;
        
        const scoreDifference = Math.abs(score1 - score2);
        const averageScore = (score1 + score2) / 2;
        const diffPercentage = (scoreDifference / averageScore) * 100;
        
        let winner;
        let analysis;
        
        if (diffPercentage < 3) {
            winner = 'draw';
            analysis = 'ูุนุฑูุฉ ูุชูุงุฒูุฉ ุฌุฏุงู! ููุง ุงูุทุฑููู ุฃุธูุฑุง ููุฉ ูุชุณุงููุฉ ุชูุฑูุจุงู.';
        } else if (score1 > score2) {
            winner = 'challenger1';
            if (diffPercentage < 15) {
                analysis = 'ููุฒ ุตุนุจ ูููุชุญุฏู ุงูุฃูู! ุงููุนุฑูุฉ ูุงูุช ูุชูุงุฑุจุฉ ูุงููุตุฑ ุฌุงุก ุจูุงุฑู ุถุฆูู.';
            } else if (diffPercentage < 35) {
                analysis = 'ููุฒ ูุงุถุญ ูููุชุญุฏู ุงูุฃูู! ุงูุชุดูููุฉ ูุงูุชูุชููุงุช ูุงูุช ุฃูุถู ูู ุงูุฎุตู.';
            } else {
                analysis = 'ููุฒ ุณุงุญู ูููุชุญุฏู ุงูุฃูู! ุชููู ูุจูุฑ ูู ุงูููุฉ ูุงูุงุณุชุฑุงุชูุฌูุฉ.';
            }
        } else {
            winner = 'challenger2';
            if (diffPercentage < 15) {
                analysis = 'ููุฒ ุตุนุจ ูููุชุญุฏู ุงูุซุงูู! ุงููุนุฑูุฉ ูุงูุช ูุชูุงุฑุจุฉ ูุงููุตุฑ ุฌุงุก ุจูุงุฑู ุถุฆูู.';
            } else if (diffPercentage < 35) {
                analysis = 'ููุฒ ูุงุถุญ ูููุชุญุฏู ุงูุซุงูู! ุงูุชุดูููุฉ ูุงูุชูุชููุงุช ูุงูุช ุฃูุถู ูู ุงูุฎุตู.';
            } else {
                analysis = 'ููุฒ ุณุงุญู ูููุชุญุฏู ุงูุซุงูู! ุชููู ูุจูุฑ ูู ุงูููุฉ ูุงูุงุณุชุฑุงุชูุฌูุฉ.';
            }
        }
        
        return {
            winner,
            analysis,
            scoreDifference: Math.round(scoreDifference),
            diffPercentage: Math.round(diffPercentage * 10) / 10,
            score1: Math.round(score1),
            score2: Math.round(score2)
        };
    }

    function getCombatSkills(level) {
        const skills = [];
        
        // ุงูููุงุฑุงุช ุงูุชููุงุฆูุฉ ูุฌููุน ุงููุณุชููุงุช
        skills.push({
            name: 'ุณูุฏ ุงูุดุฌุนุงู',
            description: '+10% ุถุฑุฑ ุถุฏ ุฑูุงุฉ ุงูุฑูุญ'
        });
        
        skills.push({
            name: 'ุฏุนุงูุงุช ูููุงุฐูุฉ',
            description: '+10% ุฏูุงุน ุถุฏ ุฑูุงุฉ ุงูุฑูุญ'
        });
        
        skills.push({
            name: 'ุงูุงูุฏูุงุน',
            description: '+10% ุถุฑุฑ ูุฑูุงุฉ ุงูุฑูุญ'
        });
        
        skills.push({
            name: 'ุงููุชุฑุจุต',
            description: '20% ูุฑุตุฉ ูุชุฌุงูุฒ ุงูุตู ุงูุฃูุงูู'
        });
        
        skills.push({
            name: 'ุถุฑุจุฉ ุจุนูุฏุฉ ุงููุฏู',
            description: '+10% ุถุฑุฑ ููุฑูุงุฉ ุถุฏ ุงููุดุงุฉ'
        });
        
        // ููุงุฑุงุช ุงููุณุชูู ูููุดุงุฉ
        if (level >= 3) {
            skills.push({
                name: 'ูุฑูุณุชุงู ูุงุฑู',
                description: 'ุชูููู 25% ูู ุงูุถุฑุฑ ุงููุงุฑุฏ ุนูู ุงููุดุงุฉ'
            });
        }
        
        if (level >= 5) {
            skills.push({
                name: 'ูุฑูุณุชุงู ุฃููู',
                description: 'ุชูููู 35% ูู ุงูุถุฑุฑ ุงููุงุฑุฏ ุนูู ุงููุดุงุฉ'
            });
        }
        
        if (level >= 8) {
            skills.push({
                name: 'ุฌุณู ุงูุถูุก',
                description: '+4% ุฏูุงุน ู -10% ุถุฑุฑ ูููุดุงุฉ'
            });
        }
        
        if (level >= 10) {
            skills.push({
                name: 'ุฌุณู ุงูุถูุก II',
                description: '+6% ุฏูุงุน ู -15% ุถุฑุฑ ูููุดุงุฉ'
            });
        }
        
        return skills;
    }

    function showBattleCountdown(callback) {
        let count = 3;
        const countdownElement = document.createElement('div');
        countdownElement.style.cssText = 'text-align: center; font-size: 48px; font-weight: bold; color: #e74c3c; margin: 30px 0; animation: pulse 1s infinite;';
        countdownElement.textContent = count;
        
        document.getElementById('battlePreparation').appendChild(countdownElement);
        
        const interval = setInterval(() => {
            count--;
            if (count > 0) {
                countdownElement.textContent = count;
            } else {
                countdownElement.textContent = 'ูุนุฑูุฉ!';
                setTimeout(() => {
                    countdownElement.remove();
                    callback();
                }, 1000);
                clearInterval(interval);
            }
        }, 1000);
    }

    function displayChallengeBattleResults(result) {
        document.getElementById('battlePreparation').style.display = 'none';
        
        const resultElement = document.getElementById('challengeBattleResults');
        
        let winnerText, winnerClass, challengeWinnerName;
        
        if (result.challengeWinner === 'draw') {
            winnerText = '๐ค ุชุนุงุฏู!';
            winnerClass = 'draw';
            challengeWinnerName = 'ุชุนุงุฏู';
        } else {
            challengeWinnerName = `${result.challengeWinner.name} (${result.challengeWinner.server})`;
            winnerText = `๐ ููุฒ ${challengeWinnerName}!`;
            winnerClass = result.winner;
        }
        
        const factionName = result.faction === 'helios' ? 'ูููููุณ' : 'ุงูููููููู';
        
        const html = `
            <div class="battle-winner ${winnerClass}">
                ${winnerText}
            </div>
            <div class="battle-details">
                <h4>ูุชูุฌุฉ ุงูุชุญุฏู:</h4>
                <div class="vs-indicator">
                    ${result.battleResult.challenger1.name} (${result.battleResult.challenger1.server}) 
                    VS 
                    ${result.battleResult.challenger2.name} (${result.battleResult.challenger2.server})
                </div>
                <div style="background-color: #e8f5e9; padding: 15px; border-radius: 5px; margin: 15px 0;">
                    <h5>๐ ุชุญููู ุงููุนุฑูุฉ:</h5>
                    <p><strong>${result.analysis.analysis}</strong></p>
                    <p>ูุงุฑู ุงูููุงุท: ${result.analysis.scoreDifference.toLocaleString()} (${result.analysis.diffPercentage}%)</p>
                </div>
                <div class="battle-stats">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div style="border-left: 4px solid #dc3545; padding-left: 15px;">
                            <h5>${result.battleResult.challenger1.name} - ${factionName} ูุณุชูู ${result.level}:</h5>
                            <p>ููุงุท ุงููุนุฑูุฉ: ${result.analysis.score1.toLocaleString()}</p>
                            <p>ุงูุถุฑุฑ ุงูุฅุฌูุงูู: ${Math.floor(result.challenger1Damage.totalDamage).toLocaleString()}</p>
                            <p>ุงููุดุงุฉ: ${result.challenger1Army.infantry.toLocaleString()}</p>
                            <p>ุงูุฑูุงุฉ: ${result.challenger1Army.archers.toLocaleString()}</p>
                            <p>ุงูุฑูุญ: ${result.challenger1Army.spearmen.toLocaleString()}</p>
                        </div>
                        <div style="border-left: 4px solid #ffc107; padding-left: 15px;">
                            <h5>${result.battleResult.challenger2.name} - ${factionName} ูุณุชูู ${result.level}:</h5>
                            <p>ููุงุท ุงููุนุฑูุฉ: ${result.analysis.score2.toLocaleString()}</p>
                            <p>ุงูุถุฑุฑ ุงูุฅุฌูุงูู: ${Math.floor(result.challenger2Damage.totalDamage).toLocaleString()}</p>
                            <p>ุงููุดุงุฉ: ${result.challenger2Army.infantry.toLocaleString()}</p>
                            <p>ุงูุฑูุงุฉ: ${result.challenger2Army.archers.toLocaleString()}</p>
                            <p>ุงูุฑูุญ: ${result.challenger2Army.spearmen.toLocaleString()}</p>
                        </div>
                    </div>
                    
                    <!-- Skills Applied -->
                    <div style="margin-top: 20px; padding: 15px; background-color: #fff8e1; border-radius: 5px;">
                        <h5>โ๏ธ ุงูููุงุฑุงุช ุงููุทุจูุฉ ูู ุงููุนุฑูุฉ:</h5>
                        <div class="skill-list">
                            ${getCombatSkills(result.level).map(skill => `<span class="skill-item" title="${skill.description}">${skill.name}</span>`).join('')}
                        </div>
                    </div>
                </div>
                
                <!-- Battle Chart -->
                <div class="chart-container" style="height: 350px; margin: 20px 0;">
                    <canvas id="challengeBattleChart"></canvas>
                </div>
                
                <!-- Share Results Section -->
                <div class="share-results" style="text-align: center; margin: 20px 0; padding: 20px; background-color: #f8f9fa; border-radius: 8px;">
                    <h5>๐ค ุดุงุฑู ูุชูุฌุฉ ุงููุนุฑูุฉ</h5>
                    <div class="share-buttons" style="display: flex; justify-content: center; gap: 15px; margin-top: 15px; flex-wrap: wrap;">
                        <button onclick="shareToWhatsApp('${result.battleResult.challenger1.name}', '${result.battleResult.challenger2.name}', '${challengeWinnerName}', '${factionName}', ${result.level}, '${result.analysis.analysis}')" class="share-btn whatsapp-btn" title="ูุดุงุฑูุฉ ุนุจุฑ ูุงุชุณุงุจ">
                            <i class="fab fa-whatsapp"></i> ูุงุชุณุงุจ
                        </button>
                        <button onclick="shareToTelegram('${result.battleResult.challenger1.name}', '${result.battleResult.challenger2.name}', '${challengeWinnerName}', '${factionName}', ${result.level}, '${result.analysis.analysis}')" class="share-btn telegram-btn" title="ูุดุงุฑูุฉ ุนุจุฑ ุชููุฌุฑุงู">
                            <i class="fab fa-telegram"></i> ุชููุฌุฑุงู
                        </button>
                        <button onclick="shareToTwitter('${result.battleResult.challenger1.name}', '${result.battleResult.challenger2.name}', '${challengeWinnerName}', '${factionName}', ${result.level}')" class="share-btn twitter-btn" title="ูุดุงุฑูุฉ ุนุจุฑ ุชููุชุฑ">
                            <i class="fab fa-twitter"></i> ุชููุชุฑ
                        </button>
                        <button onclick="shareToFacebook('${result.battleResult.challenger1.name}', '${result.battleResult.challenger2.name}', '${challengeWinnerName}', '${factionName}', ${result.level}')" class="share-btn facebook-btn" title="ูุดุงุฑูุฉ ุนุจุฑ ููุณุจูู">
                            <i class="fab fa-facebook"></i> ููุณุจูู
                        </button>
                        <button onclick="copyResultText('${result.battleResult.challenger1.name}', '${result.battleResult.challenger2.name}', '${challengeWinnerName}', '${factionName}', ${result.level}, '${result.analysis.analysis}')" class="share-btn copy-btn" title="ูุณุฎ ุงููุต">
                            <i class="fas fa-copy"></i> ูุณุฎ ุงููุต
                        </button>
                    </div>
                </div>
            </div>
        `;
        
        // ุฅุถุงูุฉ ุงูุฑุณู ุงูุจูุงูู
        setTimeout(() => {
            createBattleChart(result);
        }, 100);
        
        resultElement.innerHTML = html;
        resultElement.style.display = 'block';
        
        currentChallenge = null;
        
        // ุฅุถุงูุฉ ุงููุงุฆุฒ ุฅูู ูุงุฆูุฉ ุงููุงุฆุฒูู
        addToWinnersList(result.challengeWinner, result.battleResult);
    }
    
    function createBattleChart(result) {
        const ctx = document.getElementById('challengeBattleChart');
        if (!ctx) return;
        
        // ุชุฏููุฑ ุงูุฑุณู ุงูุจูุงูู ุงูุณุงุจู ุฅู ูุฌุฏ
        if (window.challengeBattleChartInstance) {
            window.challengeBattleChartInstance.destroy();
        }
        
        const challenger1Name = result.battleResult.challenger1.name;
        const challenger2Name = result.battleResult.challenger2.name;
        
        window.challengeBattleChartInstance = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: [challenger1Name, challenger2Name],
                datasets: [
                    {
                        label: 'ููุงุท ุงููุนุฑูุฉ ุงูุฅุฌูุงููุฉ',
                        data: [result.analysis.score1, result.analysis.score2],
                        backgroundColor: [
                            'rgba(220, 53, 69, 0.8)',  // ุฃุญูุฑ ูููุชุญุฏู ุงูุฃูู
                            'rgba(255, 193, 7, 0.8)'   // ุฃุตูุฑ ูููุชุญุฏู ุงูุซุงูู
                        ],
                        borderColor: [
                            'rgba(220, 53, 69, 1)',
                            'rgba(255, 193, 7, 1)'
                        ],
                        borderWidth: 2
                    },
                    {
                        label: 'ุงูุถุฑุฑ ุงูุฅุฌูุงูู',
                        data: [result.challenger1Damage.totalDamage, result.challenger2Damage.totalDamage],
                        backgroundColor: [
                            'rgba(220, 53, 69, 0.6)',
                            'rgba(255, 193, 7, 0.6)'
                        ]
                    },
                    {
                        label: 'ููุงุท ุงูุจูุงุก',
                        data: [result.challenger1Damage.survivalScore, result.challenger2Damage.survivalScore],
                        backgroundColor: [
                            'rgba(220, 53, 69, 0.4)',
                            'rgba(255, 193, 7, 0.4)'
                        ]
                    },
                    {
                        label: 'ุงูููุฒุฉ ุงูุชูุชูููุฉ',
                        data: [result.challenger1Damage.tacticalAdvantage, result.challenger2Damage.tacticalAdvantage],
                        backgroundColor: [
                            'rgba(220, 53, 69, 0.3)',
                            'rgba(255, 193, 7, 0.3)'
                        ]
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    title: {
                        display: true,
                        text: `ุชุญููู ุงููุนุฑูุฉ - ${result.faction === 'helios' ? 'ูููููุณ' : 'ุงูููููููู'} ูุณุชูู ${result.level}`,
                        font: {
                            size: 16,
                            weight: 'bold'
                        }
                    },
                    legend: {
                        display: true,
                        position: 'top'
                    },
                    tooltip: {
                        callbacks: {
                            afterLabel: function(context) {
                                if (context.datasetIndex === 0) {
                                    const percentage = result.analysis.diffPercentage;
                                    return `ูุงุฑู: ${percentage}%`;
                                }
                                return '';
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: 'ุงูููุงุท'
                        },
                        ticks: {
                            callback: function(value) {
                                return value.toLocaleString();
                            }
                        }
                    },
                    x: {
                        title: {
                            display: true,
                            text: 'ุงููุชุญุฏูุงู'
                        }
                    }
                },
                animation: {
                    duration: 2000,
                    easing: 'easeInOutQuart'
                }
            }
        });
        
        // ุฅุถุงูุฉ ูุคุดุฑ ุงููุงุฆุฒ ุนูู ุงูุฑุณู ุงูุจูุงูู
        setTimeout(() => {
            if (result.winner !== 'draw') {
                const winnerIndex = result.winner === 'challenger1' ? 0 : 1;
                const chart = window.challengeBattleChartInstance;
                const meta = chart.getDatasetMeta(0);
                const bar = meta.data[winnerIndex];
                
                // ุฅุถุงูุฉ ุชุฃุซูุฑ ุจุตุฑู ูููุงุฆุฒ
                const ctx = chart.ctx;
                ctx.save();
                ctx.fillStyle = 'gold';
                ctx.font = 'bold 16px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('๐', bar.x, bar.y - 20);
                ctx.restore();
            }
        }, 2100);
    }
    
    function addToWinnersList(winner, battleResult) {
        if (winner === 'draw') return;
        
        const winnersList = JSON.parse(localStorage.getItem('winnersList') || '[]');
        const winnerEntry = {
            name: winner.name,
            server: winner.server,
            opponent: winner.name === battleResult.challenger1.name ? battleResult.challenger2 : battleResult.challenger1,
            level: battleResult.level,
            timestamp: battleResult.timestamp,
            date: new Date().toLocaleDateString('ar-EG')
        };
        
        winnersList.unshift(winnerEntry); // ุฅุถุงูุฉ ูู ุงูููุฏูุฉ
        
        // ุงูุงุญุชูุงุธ ุจุขุฎุฑ 10 ูุงุฆุฒูู ููุท
        if (winnersList.length > 10) {
            winnersList.splice(10);
        }
        
        localStorage.setItem('winnersList', JSON.stringify(winnersList));
        displayWinnersList();
    }
    
    function displayWinnersList() {
        const winnersList = JSON.parse(localStorage.getItem('winnersList') || '[]');
        
        // ุฅุถุงูุฉ ูุณู ุงููุงุฆุฒูู ุฅุฐุง ูู ููู ููุฌูุฏุงู
        let winnersSection = document.getElementById('winnersListSection');
        if (!winnersSection) {
            winnersSection = document.createElement('div');
            winnersSection.id = 'winnersListSection';
            winnersSection.className = 'challenge-list';
            winnersSection.innerHTML = `
                <h3>๐ ุขุฎุฑ ุงููุงุฆุฒูู</h3>
                <div id="winnersListContent"></div>
            `;
            
            // ุฅุฏุฑุงุฌ ูุจู ูุณู ุงูุชุญุฏูุงุช ุงููุชุงุญุฉ
            const challengesList = document.querySelector('.challenge-list');
            challengesList.parentNode.insertBefore(winnersSection, challengesList);
        }
        
        const winnersContent = document.getElementById('winnersListContent');
        
        if (winnersList.length === 0) {
            winnersContent.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">ูู ุชุญุฏุซ ูุนุงุฑู ุจุนุฏ</p>';
            return;
        }
        
        const winnersHTML = winnersList.map((winner, index) => `
            <div class="challenge-item" style="border-right-color: ${index === 0 ? '#ffd700' : '#28a745'};">
                <div class="challenge-info">
                    <h5>${index === 0 ? '๐' : '๐'} ${winner.name} (${winner.server})</h5>
                    <p>ูุฒู ${winner.opponent.name} (${winner.opponent.server})</p>
                    <p>ุงููุณุชูู ${winner.level} - ${winner.date}</p>
                </div>
            </div>
        `).join('');
        
        winnersContent.innerHTML = winnersHTML;
    }

    function loadChallenges() {
        const challengesListElement = document.getElementById('challengesList');
        
        if (challenges.length === 0) {
            challengesListElement.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">ูุง ุชูุฌุฏ ุชุญุฏูุงุช ูุชุงุญุฉ ุญุงููุงู</p>';
            return;
        }
        
        const challengesHTML = challenges.map(challenge => {
            const factionName = challenge.faction === 'helios' ? 'ูููููุณ' : 'ุงูููููููู';
            const roleName = challenge.role === 'attacker' ? 'ููุงุฌู' : 'ูุฏุงูุน';
            
            return `
                <div class="challenge-item">
                    <div class="challenge-info">
                        <h5>${challenge.challenger.name} (${challenge.challenger.server})</h5>
                        <p>ุงููุณุชูู ${challenge.level} - ${factionName} (${roleName})</p>
                        <p>ุงูุชุดูููุฉ: ${challenge.composition.infantry}% ูุดุงุฉุ ${challenge.composition.archer}% ุฑูุงุฉุ ${challenge.composition.lancer}% ุฑูุญ</p>
                    </div>
                    <div class="challenge-actions">
                        <button class="btn-accept" onclick="acceptChallenge(${challenge.id})">ูุจูู ุงูุชุญุฏู</button>
                        <small style="display: block; margin-top: 5px; color: #666; font-size: 12px;">
                            ุณููุทูุจ ููู ุชุณุฌูู ุงุณูู ูุฑูู ุณูุฑูุฑู
                        </small>
                    </div>
                </div>
            `;
        }).join('');
        
        challengesListElement.innerHTML = challengesHTML;
    }

    function updateWeeklyChampion(winner) {
        if (winner === 'draw') return;
        
        const currentWeek = getWeekNumber(new Date());
        
        if (!weeklyChampion || weeklyChampion.week !== currentWeek) {
            weeklyChampion = {
                player: winner,
                wins: 1,
                week: currentWeek
            };
        } else if (weeklyChampion.player.name === winner.name && weeklyChampion.player.server === winner.server) {
            weeklyChampion.wins++;
        } else {
            const winnerWins = battleResults.filter(result => 
                getWeekNumber(new Date(result.timestamp)) === currentWeek &&
                result.winner !== 'draw' &&
                result.winner.name === winner.name &&
                result.winner.server === winner.server
            ).length;
            
            if (winnerWins > weeklyChampion.wins) {
                weeklyChampion = {
                    player: winner,
                    wins: winnerWins,
                    week: currentWeek
                };
            }
        }
        
        localStorage.setItem('weeklyChampion', JSON.stringify(weeklyChampion));
        loadWeeklyChampion();
    }

    function loadWeeklyChampion() {
        const currentWeek = getWeekNumber(new Date());
        const dayOfWeek = new Date().getDay(); // 0 = ุงูุฃุญุฏุ 6 = ุงูุณุจุช
        
        // ุฅุฎูุงุก ุจุทู ุงูุฃุณุจูุน ุญุชู ููุงูุฉ ุงูุฃุณุจูุน (ุงูุณุจุช)
        if (dayOfWeek < 6) {
            document.getElementById('championName').textContent = 'ุณูุชู ุงูุฅุนูุงู ุนู ุงูุจุทู ููุงูุฉ ุงูุฃุณุจูุน';
            document.getElementById('championWins').textContent = '?';
            document.getElementById('championServer').textContent = '----';
            document.getElementById('championLevel').textContent = '-';
            
            // ุฅุถุงูุฉ ุฑุณุงูุฉ ุงูุชุดููู
            const championSection = document.getElementById('weeklyChampion');
            if (championSection && !championSection.querySelector('.suspense-message')) {
                const suspenseMsg = document.createElement('div');
                suspenseMsg.className = 'suspense-message';
                suspenseMsg.style.cssText = 'margin-top: 10px; font-style: italic; color: #666; font-size: 14px;';
                suspenseMsg.textContent = `ุงููุนุงุฑู ุฌุงุฑูุฉ... ุงูุจุทู ุณููุนูู ููู ุงูุณุจุช!`;
                championSection.appendChild(suspenseMsg);
            }
            return;
        }
        
        // ุฅุฒุงูุฉ ุฑุณุงูุฉ ุงูุชุดููู ุฅุฐุง ูุงูุช ููุฌูุฏุฉ
        const suspenseMsg = document.querySelector('.suspense-message');
        if (suspenseMsg) {
            suspenseMsg.remove();
        }
        
        if (!weeklyChampion || weeklyChampion.week !== currentWeek) {
            document.getElementById('championName').textContent = 'ูุง ููุฌุฏ ุจุทู ูุฐุง ุงูุฃุณุจูุน';
            document.getElementById('championWins').textContent = '0';
            document.getElementById('championServer').textContent = '----';
            document.getElementById('championLevel').textContent = '-';
            return;
        }
        
        document.getElementById('championName').textContent = weeklyChampion.player.name;
        document.getElementById('championWins').textContent = weeklyChampion.wins;
        document.getElementById('championServer').textContent = weeklyChampion.player.server;
        
        const championResults = battleResults.filter(result => 
            result.winner !== 'draw' &&
            result.winner.name === weeklyChampion.player.name &&
            result.winner.server === weeklyChampion.player.server &&
            getWeekNumber(new Date(result.timestamp)) === currentWeek
        );
        
        if (championResults.length > 0) {
            const levels = championResults.map(result => result.level);
            const mostCommonLevel = levels.sort((a,b) =>
                levels.filter(v => v === a).length - levels.filter(v => v === b).length
            ).pop();
            document.getElementById('championLevel').textContent = mostCommonLevel;
        } else {
            document.getElementById('championLevel').textContent = '-';
        }
    }

    function getWeekNumber(date) {
        const startDate = new Date(date.getFullYear(), 0, 1);
        const days = Math.floor((date - startDate) / (24 * 60 * 60 * 1000));
        return Math.ceil((days + startDate.getDay() + 1) / 7);
    }

    // Initialize challenge system on page load
    document.addEventListener('DOMContentLoaded', function() {
        const savedPlayer = localStorage.getItem('currentPlayer');
        if (savedPlayer) {
            currentPlayer = JSON.parse(savedPlayer);
            document.getElementById('playerName').value = currentPlayer.name;
            document.getElementById('serverNumber').value = currentPlayer.server;
            document.getElementById('challengeCreationSection').style.display = 'block';
        }
        
        updateChallengeSkills();
        updateChallengeComposition();
        loadWeeklyChampion();
        loadChallenges();
        displayWinnersList();
    });

    // Share Results Functions
    function generateShareText(challenger1, challenger2, winner, faction, level, analysis) {
        const gameTitle = "๐ฎ Whiteout Survival - ูุญุงูุงุฉ ุงููุนุงุฑู ๐ฎ\n\n";
        const battleInfo = `โ๏ธ ูุนุฑูุฉ ููุญููุฉ ูู ${faction} ูุณุชูู ${level}!\n\n`;
        const participants = `๐ฅ ${challenger1} VS ${challenger2}\n\n`;
        const result = winner === 'ุชุนุงุฏู' ? '๐ค ุงููุชูุฌุฉ: ุชุนุงุฏู ูุซูุฑ!' : `๐ ุงููุงุฆุฒ: ${winner}!`;
        const analysisText = analysis ? `\n\n๐ ${analysis}` : '';
        const appPromo = '\n\n๐ ุฌุฑุจ ูุญุงูุงุฉ ุงููุนุงุฑู: https://abukhat.github.io/whiteout/';
        
        return gameTitle + battleInfo + participants + result + analysisText + appPromo;
    }

    function shareToWhatsApp(challenger1, challenger2, winner, faction, level, analysis) {
        const text = generateShareText(challenger1, challenger2, winner, faction, level, analysis);
        const encodedText = encodeURIComponent(text);
        const whatsappUrl = `https://wa.me/?text=${encodedText}`;
        
        window.open(whatsappUrl, '_blank');
        
        // ุชุชุจุน ุงูุฅุญุตุงุฆูุงุช
        if (typeof gtag !== 'undefined') {
            gtag('event', 'share', {
                'method': 'whatsapp',
                'content_type': 'battle_result'
            });
        }
    }

    function shareToTelegram(challenger1, challenger2, winner, faction, level, analysis) {
        const text = generateShareText(challenger1, challenger2, winner, faction, level, analysis);
        const encodedText = encodeURIComponent(text);
        const telegramUrl = `https://t.me/share/url?url=https://abukhat.github.io/whiteout/&text=${encodedText}`;
        
        window.open(telegramUrl, '_blank');
        
        if (typeof gtag !== 'undefined') {
            gtag('event', 'share', {
                'method': 'telegram',
                'content_type': 'battle_result'
            });
        }
    }

    function shareToTwitter(challenger1, challenger2, winner, faction, level) {
        const text = `๐ฎ ูุนุฑูุฉ ููุญููุฉ ูู Whiteout Survival!\nโ๏ธ ${challenger1} VS ${challenger2}\n๐ ุงููุงุฆุฒ: ${winner}\n๐ฅ ${faction} ูุณุชูู ${level}\n\n#WhiteoutSurvival #ูุญุงูุงุฉ_ุงููุนุงุฑู`;
        const encodedText = encodeURIComponent(text);
        const twitterUrl = `https://twitter.com/intent/tweet?text=${encodedText}&url=https://abukhat.github.io/whiteout/`;
        
        window.open(twitterUrl, '_blank');
        
        if (typeof gtag !== 'undefined') {
            gtag('event', 'share', {
                'method': 'twitter',
                'content_type': 'battle_result'
            });
        }
    }

    function shareToFacebook(challenger1, challenger2, winner, faction, level) {
        const facebookUrl = `https://www.facebook.com/sharer/sharer.php?u=https://abukhat.github.io/whiteout/&quote=${encodeURIComponent(`๐ฎ ูุนุฑูุฉ ููุญููุฉ ูู Whiteout Survival! ${challenger1} VS ${challenger2} - ุงููุงุฆุฒ: ${winner} (${faction} ูุณุชูู ${level})`)}`;
        
        window.open(facebookUrl, '_blank');
        
        if (typeof gtag !== 'undefined') {
            gtag('event', 'share', {
                'method': 'facebook',
                'content_type': 'battle_result'
            });
        }
    }

    function copyResultText(challenger1, challenger2, winner, faction, level, analysis) {
        const text = generateShareText(challenger1, challenger2, winner, faction, level, analysis);
        
        // ูุณุฎ ุงููุต ุฅูู ุงูุญุงูุธุฉ
        if (navigator.clipboard && window.isSecureContext) {
            navigator.clipboard.writeText(text).then(() => {
                showShareNotification('ุชู ูุณุฎ ุงููุชูุฌุฉ ุฅูู ุงูุญุงูุธุฉ! ๐');
            }).catch(err => {
                fallbackCopyText(text);
            });
        } else {
            fallbackCopyText(text);
        }
        
        if (typeof gtag !== 'undefined') {
            gtag('event', 'copy', {
                'method': 'clipboard',
                'content_type': 'battle_result'
            });
        }
    }

    function fallbackCopyText(text) {
        const textArea = document.createElement('textarea');
        textArea.value = text;
        textArea.style.position = 'fixed';
        textArea.style.left = '-999999px';
        textArea.style.top = '-999999px';
        document.body.appendChild(textArea);
        textArea.focus();
        textArea.select();
        
        try {
            document.execCommand('copy');
            showShareNotification('ุชู ูุณุฎ ุงููุชูุฌุฉ ุฅูู ุงูุญุงูุธุฉ! ๐');
        } catch (err) {
            showShareNotification('ูู ูุชู ุงููุณุฎ. ูุฑุฌู ุงููุณุฎ ูุฏููุงู.');
            // ุนุฑุถ ุงููุต ูู ูุงูุฐุฉ ููุจุซูุฉ ูููุณุฎ ุงููุฏูู
            prompt('ุงูุณุฎ ุงููุต ุงูุชุงูู:', text);
        }
        
        document.body.removeChild(textArea);
    }

    function showShareNotification(message) {
        // ุฅูุดุงุก ุฅุดุนุงุฑ ูุคูุช
        const notification = document.createElement('div');
        notification.style.cssText = `
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: #28a745;
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            font-weight: bold;
            z-index: 10000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            animation: slideInRight 0.3s ease-out;
        `;
        notification.textContent = message;
        
        // ุฅุถุงูุฉ CSS animation
        if (!document.querySelector('#shareNotificationStyle')) {
            const style = document.createElement('style');
            style.id = 'shareNotificationStyle';
            style.textContent = `
                @keyframes slideInRight {
                    from {
                        transform: translateX(100%);
                        opacity: 0;
                    }
                    to {
                        transform: translateX(0);
                        opacity: 1;
                    }
                }
                @keyframes slideOutRight {
                    from {
                        transform: translateX(0);
                        opacity: 1;
                    }
                    to {
                        transform: translateX(100%);
                        opacity: 0;
                    }
                }
            `;
            document.head.appendChild(style);
        }
        
        document.body.appendChild(notification);
        
        // ุฅุฒุงูุฉ ุงูุฅุดุนุงุฑ ุจุนุฏ 3 ุซูุงูู
        setTimeout(() => {
            notification.style.animation = 'slideOutRight 0.3s ease-in';
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 300);
        }, 3000);
    }

    // Comments System Functions
    let comments = JSON.parse(localStorage.getItem('battleComments') || '[]');

    function addComment() {
        const authorInput = document.getElementById('commentAuthor');
        const textInput = document.getElementById('commentText');
        
        const author = authorInput.value.trim();
        const text = textInput.value.trim();
        
        if (!author) {
            alert('ูุฑุฌู ุฅุฏุฎุงู ุงุณูู');
            return;
        }
        
        if (!text) {
            alert('ูุฑุฌู ูุชุงุจุฉ ุชุนููู');
            return;
        }
        
        if (text.length > 500) {
            alert('ุงูุชุนููู ุทููู ุฌุฏุงู (ุงูุญุฏ ุงูุฃูุตู 500 ุญุฑู)');
            return;
        }
        
        const comment = {
            id: Date.now(),
            author: author,
            text: text,
            timestamp: new Date().toISOString(),
            date: new Date().toLocaleDateString('ar-EG', {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            })
        };
        
        comments.unshift(comment); // ุฅุถุงูุฉ ูู ุงูููุฏูุฉ
        
        // ุงูุงุญุชูุงุธ ุจุขุฎุฑ 50 ุชุนููู ููุท
        if (comments.length > 50) {
            comments.splice(50);
        }
        
        localStorage.setItem('battleComments', JSON.stringify(comments));
        
        // ูุณุญ ุงููููุฐุฌ
        authorInput.value = '';
        textInput.value = '';
        
        // ุชุญุฏูุซ ุงูุชุนูููุงุช
        loadComments();
        
        // ุฅุดุนุงุฑ ุงููุฌุงุญ
        showCommentNotification('ุชู ุฅุถุงูุฉ ุชุนูููู ุจูุฌุงุญ! ๐');
        
        // ุชุชุจุน ุฅุถุงูุฉ ุงูุชุนููู
        if (typeof gtag !== 'undefined') {
            gtag('event', 'comment_added', {
                'event_category': 'Engagement',
                'event_label': 'Battle Comments'
            });
        }
    }

    function loadComments() {
        const commentsList = document.getElementById('commentsList');
        const commentsCount = document.getElementById('commentsCount');
        
        commentsCount.textContent = comments.length;
        
        if (comments.length === 0) {
            commentsList.innerHTML = `
                <div style="text-align: center; padding: 30px; color: #666;">
                    <i class="fas fa-comment-slash" style="font-size: 48px; margin-bottom: 15px; color: #ddd;"></i>
                    <p>ูุง ุชูุฌุฏ ุชุนูููุงุช ุจุนุฏ</p>
                    <p style="font-size: 14px;">ูู ุฃูู ูู ูุนูู ุนูู ุงููููุน!</p>
                </div>
            `;
            return;
        }
        
        const commentsHTML = comments.map(comment => `
            <div class="comment-item">
                <div class="comment-header">
                    <span class="comment-author">
                        <i class="fas fa-user-circle"></i> ${escapeHtml(comment.author)}
                    </span>
                    <span class="comment-date">
                        <i class="fas fa-clock"></i> ${comment.date}
                    </span>
                </div>
                <div class="comment-text">${escapeHtml(comment.text)}</div>
            </div>
        `).join('');
        
        commentsList.innerHTML = commentsHTML;
    }

    function escapeHtml(text) {
        const map = {
            '&': '&amp;',
            '<': '&lt;',
            '>': '&gt;',
            '"': '&quot;',
            "'": '&#039;'
        };
        return text.replace(/[&<>"']/g, function(m) { return map[m]; });
    }

    function showCommentNotification(message) {
        const notification = document.createElement('div');
        notification.style.cssText = `
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #17a2b8, #138496);
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            font-weight: bold;
            z-index: 10000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            animation: slideInRight 0.3s ease-out;
            max-width: 300px;
        `;
        notification.textContent = message;
        
        document.body.appendChild(notification);
        
        setTimeout(() => {
            notification.style.animation = 'slideOutRight 0.3s ease-in';
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 300);
        }, 3000);
    }

    // ุชุญููู ุงูุชุนูููุงุช ุนูุฏ ุชุญููู ุงูุตูุญุฉ
    document.addEventListener('DOMContentLoaded', function() {
        loadComments();
        
        // ุฅุถุงูุฉ ูุณุชูุน ููุถุบุท ุนูู Enter ูู ูููุฐุฌ ุงูุชุนููู
        const commentText = document.getElementById('commentText');
        if (commentText) {
            commentText.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' && e.ctrlKey) {
                    addComment();
                }
            });
        }
    });

    // Start challenge (legacy function for compatibility)
    function startChallenge() {
        alert('ุงุณุชุฎุฏู ุงููุธุงู ุงูุฌุฏูุฏ ููุชุญุฏู ุฃุนูุงู!');
    }
    
    // Helper function to capitalize first letter
    function capitalizeFirstLetter(string) {
        return string.charAt(0).toUpperCase() + string.slice(1);
    }
    
    // Google Analytics click tracking function
    function trackClick(buttonName) {
        if (typeof gtag !== 'undefined') {
            gtag('event', 'click', {
                'event_category': 'Social Media',
                'event_label': buttonName,
                'value': 1
            });
        }
    }

    // Modal functionality
    function hideModal() {
        const modal = document.getElementById('subscriptionModal');
        modal.classList.add('hidden');
    }

    // Show modal on page load
    window.addEventListener('load', function() {
        const modal = document.getElementById('subscriptionModal');
        modal.style.display = 'flex';
    });

    // Optional: Hide modal when clicking outside the content area
    document.getElementById('subscriptionModal').addEventListener('click', function(e) {
        if (e.target === this) {
            hideModal();
        }
    });

    // Protection against code copying and theft
    // Disable right-click context menu
    document.addEventListener('contextmenu', function(e) {
        e.preventDefault();
        return false;
    });

    // Disable F12, Ctrl+Shift+I, Ctrl+Shift+J, Ctrl+U, Ctrl+Shift+C, Ctrl+S
    document.addEventListener('keydown', function(e) {
        // F12 key
        if (e.keyCode === 123) {
            e.preventDefault();
            return false;
        }
        // Ctrl+Shift+I (Developer tools)
        if (e.ctrlKey && e.shiftKey && e.keyCode === 73) {
            e.preventDefault();
            return false;
        }
        // Ctrl+Shift+J (Console)
        if (e.ctrlKey && e.shiftKey && e.keyCode === 74) {
            e.preventDefault();
            return false;
        }
        // Ctrl+U (View source)
        if (e.ctrlKey && e.keyCode === 85) {
            e.preventDefault();
            return false;
        }
        // Ctrl+Shift+C (Inspect element)
        if (e.ctrlKey && e.shiftKey && e.keyCode === 67) {
            e.preventDefault();
            return false;
        }
        // Ctrl+S (Save page)
        if (e.ctrlKey && e.keyCode === 83) {
            e.preventDefault();
            return false;
        }
        // Ctrl+A (Select all)
        if (e.ctrlKey && e.keyCode === 65) {
            e.preventDefault();
            return false;
        }
        // Ctrl+P (Print)
        if (e.ctrlKey && e.keyCode === 80) {
            e.preventDefault();
            return false;
        }
    });

    // Disable text selection with mouse
    document.onselectstart = function() {
        return false;
    };

    // Disable drag and drop
    document.ondragstart = function() {
        return false;
    };

    // Alert when developer tools are opened
    let devtools = {
        open: false,
        orientation: null
    };
    const threshold = 160;
    setInterval(function() {
        if (window.outerHeight - window.innerHeight > threshold || 
            window.outerWidth - window.innerWidth > threshold) {
            if (!devtools.open) {
                devtools.open = true;
                console.clear();
                console.log('%cโ๏ธ ุชุญุฐูุฑ: ูุญุงููุฉ ุงููุตูู ูููุฏ ุงููุตุฏุฑ', 'color: red; font-size: 30px; font-weight: bold;');
                console.log('%c๐ ูุฐุง ุงููุญุชูู ูุญูู ุจุญููู ุงูุทุจุน ูุงููุดุฑ', 'color: red; font-size: 20px;');
                console.log('%c๐ซ ุฃู ูุญุงููุฉ ููุณุฎ ุฃู ุชุนุฏูู ุงูููุฏ ูุฎุงููุฉ ูุงููููุฉ', 'color: red; font-size: 16px;');
            }
        } else {
            devtools.open = false;
        }
    }, 500);

    // Clear console periodically
    setInterval(function() {
        console.clear();
    }, 1000);

    // Disable print screen
    document.addEventListener('keyup', function(e) {
        if (e.keyCode === 44) {
            document.body.style.display = 'none';
            setTimeout(function() {
                document.body.style.display = 'block';
            }, 100);
        }
    });

    // Protection message for copy attempts
    document.addEventListener('copy', function(e) {
        e.clipboardData.setData('text/plain', 'ูุญุชูู ูุญูู - ูุง ูููู ุงููุณุฎ');
        e.preventDefault();
    });
</script>
</body>
</html>